{"version":3,"sources":["authProvider.ts","utils/http.ts","utils/index.ts","utils/useAsync.ts","components/lib.tsx","context/authContext.tsx","utils/useUsers.ts","components/idSelect.tsx","components/userSelect.tsx","screens/projectList/searchPanel.tsx","components/pin.tsx","utils/reorder.ts","utils/useOptimisticOptions.ts","utils/useProjects.ts","utils/url.ts","screens/projectList/utils.ts","screens/projectList/list.tsx","screens/projectList/index.tsx","assets/software-logo.svg","utils/task.ts","screens/kanban/util.ts","screens/epic/util.ts","screens/epic/createEpic.tsx","utils/epic.ts","screens/epic/index.tsx","utils/kanban.ts","utils/taskType.ts","assets/bug.svg","assets/task.svg","screens/kanban/createTask.tsx","components/mark.tsx","components/dragAndDrop.tsx","screens/kanban/kanbanColumn.tsx","screens/kanban/createKanban.tsx","components/taskTypeSelect.tsx","screens/kanban/searchPanel.tsx","screens/kanban/taskModal.tsx","screens/kanban/index.tsx","screens/project/index.tsx","screens/projectList/projectModal.tsx","components/projectPopover.tsx","components/userPopover.tsx","authenticatedApp.tsx","unauthenticatedApp/login.tsx","unauthenticatedApp/register.tsx","assets/logo.svg","assets/left.svg","assets/right.svg","unauthenticatedApp/index.tsx","components/errorBoundary.tsx","App.tsx","reportWebVitals.ts","context/index.tsx","index.tsx"],"names":["apiUrl","process","localStorageKey","handleUserResponse","user","window","localStorage","setItem","token","loginOut","a","removeItem","http","endpoint","data","headers","customConfig","config","method","Authorization","toUpperCase","qs","stringify","body","JSON","fetch","then","response","status","location","reload","Promise","reject","message","json","ok","useHttp","useAuth","useCallback","clearObject","object","result","Object","keys","forEach","item","value","undefined","isVoid","useDebounce","delay","useState","debounceValue","setDebounceValue","useEffect","timeout","setTimeout","clearTimeout","useDocumentTitle","title","keepOnUnMount","oldTitle","useRef","document","current","defaultInitialState","stat","error","defaultConfig","throwOnError","useSafeDispatch","dispatch","mountedRef","useMountedRef","useAsync","initialState","initialConfig","useReducer","state","action","safeDispatch","retry","setRetry","setData","setError","run","promise","runConfig","Error","catch","isIdle","isLoading","isError","isSuccess","Row","styled","div","props","marginBottom","between","gap","FullPageLoading","FullPage","size","FullPageErrorFallback","ErrorBox","massage","Text","type","ButtonNoPadding","Button","ScreenContainer","AuthContext","React","createContext","displayName","bootstrapUser","getItem","AuthProvider","callback","children","setUser","queryClient","useQueryClient","Provider","login","form","res","register","auth","clear","context","useContext","useUsers","param","client","useQuery","IdSelect","onChange","defaultOptionName","options","restProps","length","toNumber","Option","map","option","id","name","isNaN","Number","UserSelect","users","SearchPanel","setParam","style","layout","Item","placeholder","event","target","personId","Pin","checked","onCheckedChange","count","num","Boolean","reorder","fromId","referenceId","list","copiedList","moveItemIndex","findIndex","insertAfter","toId","targetIndex","insertBefore","toItem","removedItem","splice","toIndex","indexOf","useConfig","queryKey","onMutate","previousItems","getQueryData","setQueryData","old","onSuccess","variables","console","log","onError","newItem","onSettled","invalidateQueries","useDeleteConfig","filter","useEditConfig","useAddConfig","useProjects","useEditProject","useMutation","params","useAddProject","useProject","enabled","useUrlQueryParam","useSearchParams","searchParams","setSearchParams","useSetUrlSearchParams","useMemo","reduce","prev","key","get","o","fromEntries","useProjectSearchParams","useProjectModal","projectCreate","setProjectCreate","editingProjectId","setEditingProjectId","editingProject","setUrlParams","projectModalOpen","open","close","startEdit","useProjectQueryKey","List","mutate","deleteProject","useDeleteProject","pagination","columns","render","record","pin","sorter","b","localeCompare","to","String","dataIndex","find","created","dayjs","format","overlay","onClick","Modal","confirm","content","okText","cancelText","onOk","ProjectListScreen","debounceParam","Container","loading","dataSource","whyDidYouRender","_defs","_g","_extends","assign","i","arguments","source","prototype","hasOwnProperty","call","apply","this","_objectWithoutProperties","excluded","sourceKeys","_objectWithoutPropertiesLoose","getOwnPropertySymbols","sourceSymbolKeys","propertyIsEnumerable","SvgSoftwareLogo","_ref","svgRef","titleId","viewBox","xmlns","focusable","className","ref","x1","y1","x2","y2","stopColor","offset","stroke","strokeWidth","fillRule","d","fill","ForwardRef","useTasks","debouncedParam","useReorderTask","kanbanId","toKanbanId","useReorderTaskConfig","useProjectIdInUrl","useLocation","pathname","match","useProjectInUrl","useKanbanSearchParams","projectId","useKanbanQuerykey","useTasksSearchParams","typeId","processorId","tagId","useTasksQueryKey","useTasksModal","editingTaskId","setEditingTaskId","useTask","editingTask","useEpicSearchParams","useEpicQuerykey","CreateEpic","useAddEpic","addEpic","useForm","onFinish","values","onClose","resetFields","visible","forceRender","destroyOnClose","width","label","rules","required","textAlign","htmlType","EpicScreen","currentProject","epics","useEpics","tasks","deleteEpic","useDeleteEpic","epicCreateOpen","setEpicCreateOpen","overflowY","overflowX","itemLayout","renderItem","epic","Meta","startDelete","description","start","end","task","epicId","useKanbans","useReorderKanban","useReorderKanbanConfig","useTaskTypes","CreateTask","setName","addTask","useAddTask","mutateAsync","inputMode","setInputMode","submit","toggle","mode","onPressEnter","onBlur","autoFocus","evt","Mark","keyWord","arr","split","str","index","color","Drop","provided","isValidElement","cloneElement","droppableProps","innerRef","DropChild","forwardRef","Drag","draggableProps","dragHandleProps","TaskTypeIcon","taskTypes","taskType","alt","src","taskIcon","bugIcon","More","kanban","useDeleteKanban","TaskCard","cursor","KanbanColumn","allTasks","TaskContainer","droppableId","direction","minHeight","taskIndex","draggableId","CreateKanban","addKanban","useAddKanban","TaskTypeSelect","labelCol","span","wrapperCol","TaskModal","useEditTask","editTask","editLoading","deleteTask","useDeleteTask","getFieldsValue","setFieldsValue","onCancel","confirmLoading","initialValues","fontSize","KanbanScreen","kanbans","kanbanIsLoading","taskIsLoading","onDragEnd","useDragEnd","ColumnsContainer","display","reorderKanban","reorderTask","destination","fromKanbanId","fromTask","toTask","ProjectScreen","routerType","units","useRouteType","Aside","selectedKeys","Main","path","element","replace","aside","ProjectModal","mutateLoading","Form","ProjectPopover","projects","refetch","pinnedProjects","project","ContentContainer","onVisibleChange","placement","UserPopover","AuthenticatedApp","PageHeader","Header","HeaderLeft","href","origin","HeaderRight","User","e","preventDefault","main","LoginScreen","LongButton","RegisterScreen","cpassword","password","UnauthenticatedApp","isRegister","setIsRegister","Background","ShadowCard","Title","h2","left","right","header","logo","Card","ErrorBoundary","fallbackRender","Component","App","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","AppProviders","QueryClient","QueryClientProvider","loadServer","ReactDOM","StrictMode","getElementById"],"mappings":"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","file":"static/js/main.b13fda53.chunk.js","sourcesContent":["import { User } from \"types/user\";\r\n\r\nconst apiUrl = process.env.REACT_APP_API_URL;\r\n\r\nconst localStorageKey = \"__auth_provider_token__\";\r\n\r\n/** 获取token*/\r\nexport const getToken = () => {\r\n    return window.localStorage.getItem(localStorageKey);\r\n};\r\n/**将token存入localStorage */\r\nexport const handleUserResponse = ({ user }: { user: User }) => {\r\n    window.localStorage.setItem(localStorageKey, user.token || \"\");\r\n    return user;\r\n};\r\n\r\nexport const login = (data: { username: string; password: string }) => {\r\n    return fetch(`${apiUrl}/login`, {\r\n        method: \"POST\",\r\n        headers: {\r\n            \"Content-Type\": \"application/json\",\r\n        },\r\n        body: JSON.stringify(data),\r\n    }).then(async (response) => {\r\n        if (response.ok) {\r\n            return handleUserResponse(await response.json());\r\n        } else {\r\n            return Promise.reject(await response.json());\r\n        }\r\n    });\r\n};\r\n\r\nexport const register = (data: { username: string; password: string }) => {\r\n    return fetch(`${apiUrl}/register`, {\r\n        method: \"POST\",\r\n        headers: {\r\n            \"Content-Type\": \"application/json\",\r\n        },\r\n        body: JSON.stringify(data),\r\n    }).then(async (response) => {\r\n        if (response.ok) {\r\n            return handleUserResponse(await response.json());\r\n        } else {\r\n            return Promise.reject(await response.json());\r\n        }\r\n    });\r\n};\r\n\r\n/**登录 */\r\n// export const login = (data: { username: string; password: string }) => {\r\n//     return axios.post(`/login`, { ...data }).then((res) => {\r\n//         if (res.status === 200) {\r\n//             return handleUserResponse(res.data.user);\r\n//         } else {\r\n//             return Promise.reject(data);\r\n//         }\r\n//     });\r\n// };\r\n/**注册 */\r\n// export const register = (data: { username: string; password: string }) => {\r\n//     return axios.post(`/register`, { ...data }).then((res) => {\r\n//         if (res.status === 200) {\r\n//             return handleUserResponse(res.data.user);\r\n//         } else {\r\n//             return Promise.reject(data);\r\n//         }\r\n//     });\r\n// };\r\n/**登出 */\r\nexport const loginOut = async () => window.localStorage.removeItem(localStorageKey);\r\n","import qs from \"qs\";\r\n// import axios from \"axios\";\r\nimport { loginOut } from \"authProvider\";\r\nimport { useAuth } from \"context/authContext\";\r\nimport { useCallback } from \"react\";\r\nconst apiUrl = process.env.REACT_APP_API_URL;\r\n// // http request 响应器\r\n// axios.interceptors.request.use((config) => {\r\n//     console.log(config);\r\n//     config.url = apiUrl! + config.url;\r\n//     if (getToken()) config.headers.Authorization = \"bearer \" + getToken();\r\n//     return config;\r\n// });\r\n// //http request 拦截器\r\n// axios.interceptors.response.use((response) => {\r\n//     return response;\r\n// });\r\n\r\n// export default axios;\r\n\r\ninterface Config extends RequestInit {\r\n    token?: string;\r\n    data?: object;\r\n}\r\n\r\nexport const http = async (endpoint: string, { data, token, headers, ...customConfig }: Config = {}) => {\r\n    const config = {\r\n        method: \"GET\",\r\n        headers: {\r\n            Authorization: token ? `Bearer ${token}` : \"\",\r\n            \"Content-Type\": data ? \"application/json\" : \"\",\r\n        },\r\n        ...customConfig,\r\n    };\r\n    //判断get方法将data拼入endpoint\r\n    if (config.method.toUpperCase() === \"GET\") {\r\n        endpoint += `?${qs.stringify(data)}`;\r\n    } else {\r\n        config.body = JSON.stringify(data || {});\r\n    }\r\n    return window.fetch(`${apiUrl}/${endpoint}`, config).then(async (response) => {\r\n        //如果未认证\r\n        if (response.status === 401) {\r\n            await loginOut();\r\n            window.location.reload();\r\n            return Promise.reject({ message: \"请重新登录\" });\r\n        }\r\n\r\n        //如果成功\r\n        const data = await response.json();\r\n        if (response.ok) {\r\n            return data;\r\n        } else {\r\n            return Promise.reject(data);\r\n        }\r\n    });\r\n};\r\n/**使用fetch对请求进行封装 */\r\nexport const useHttp = () => {\r\n    const { user } = useAuth();\r\n    return useCallback((...[endpoint, config]: Parameters<typeof http>) => http(endpoint, { ...config, token: user?.token }), [user?.token]);\r\n};\r\n","import { useEffect, useRef, useState } from \"react\";\r\n/**各个工具函数和一些简单hook */\r\n\r\nexport const isFalsy = (value: unknown): boolean => {\r\n    return value === 0 ? false : !value;\r\n};\r\n\r\nexport const isVoid = (value: unknown) => {\r\n    return value === undefined || value === null || value === \"\";\r\n};\r\n\r\nexport const clearObject = (object: { [key: string]: unknown }) => {\r\n    const result = { ...object };\r\n    Object.keys(result).forEach((item: string) => {\r\n        const value = result[item];\r\n        if (isVoid(value)) {\r\n            delete result[item];\r\n        }\r\n    });\r\n    return result;\r\n};\r\n/**初始化 */\r\nexport const useMount = (callback: () => void) => {\r\n    useEffect(() => {\r\n        callback();\r\n        //eslint-disable-next-line react-hooks/exhaustive-deps\r\n    }, []);\r\n};\r\n/**防抖函数 */\r\nexport const useDebounce = <V>(value: V, delay?: number) => {\r\n    const [debounceValue, setDebounceValue] = useState(value);\r\n    useEffect(() => {\r\n        //每次在value变化后设置一个定时器\r\n        const timeout = setTimeout(() => {\r\n            setDebounceValue(value);\r\n        }, delay);\r\n        //每次在上一个useEffect处理完后再运行\r\n        return () => {\r\n            clearTimeout(timeout);\r\n        };\r\n    }, [value, delay]);\r\n\r\n    return debounceValue;\r\n};\r\n/**数组的管理 */\r\nexport const useArray = <T>(array: T[]) => {\r\n    const [value, setValue] = useState(array);\r\n    /**清空数组 */\r\n    const clear = () => {\r\n        setValue(new Array<T>());\r\n    };\r\n    /**添加一项 */\r\n    const add = (item: T) => {\r\n        setValue([...value, item]);\r\n    };\r\n    /**下标删除一项 */\r\n    const removeIndex = (index: number) => {\r\n        setValue(value.filter((item, idx) => index !== idx));\r\n    };\r\n    return { value, clear, removeIndex, add };\r\n};\r\n\r\n/**\r\n * 操作页面的title\r\n * @param title 文档的title\r\n * @param keepOnUnMount 是否保持当前页面的title,true时保留当前标题，false 还原标题\r\n */\r\nexport const useDocumentTitle = (title: string, keepOnUnMount: boolean = true) => {\r\n    const oldTitle = useRef(document.title).current;\r\n    //更新\r\n    useEffect(() => {\r\n        document.title = title;\r\n    }, [title]);\r\n    //卸载\r\n    useEffect(() => {\r\n        return () => {\r\n            if (!keepOnUnMount) {\r\n                document.title = oldTitle;\r\n            }\r\n        };\r\n    }, [keepOnUnMount, oldTitle]);\r\n};\r\n/**重置路由到根路由 */\r\nexport const resetRoute = () => {\r\n    window.location.href = window.location.origin;\r\n};\r\n\r\n/**\r\n * 用来返回的挂载状态，如果还没挂载或者已经卸载，返回false;反之返回true\r\n */\r\nexport const useMountedRef = () => {\r\n    const mountedRef = useRef(false);\r\n    useEffect(() => {\r\n        mountedRef.current = true;\r\n        return () => {\r\n            mountedRef.current = false;\r\n        };\r\n    });\r\n    return mountedRef;\r\n};\r\n","import { useCallback, useReducer, useState } from \"react\";\r\nimport { useMountedRef } from \"utils\";\r\n\r\ninterface State<D> {\r\n    error: Error | null;\r\n    data: D | null;\r\n    /**idle：未发生，loading：进行中，error：失败，success：成功 */\r\n    stat: \"idle\" | \"loading\" | \"error\" | \"success\";\r\n}\r\n//默认初值\r\nconst defaultInitialState: State<null> = {\r\n    stat: \"idle\",\r\n    data: null,\r\n    error: null,\r\n};\r\nconst defaultConfig = {\r\n    throwOnError: false, //用于判断是否需要主动抛出异常\r\n};\r\n\r\nconst useSafeDispatch = <T>(dispatch: (...args: T[]) => void) => {\r\n    const mountedRef = useMountedRef();\r\n    return useCallback(\r\n        (...args: T[]) => {\r\n            return mountedRef.current ? dispatch(...args) : void 0;\r\n        },\r\n        [mountedRef, dispatch]\r\n    );\r\n};\r\n\r\n/**\r\n * 用于数据的异步请求\r\n * @param initialState\r\n * @param initialConfig 初始化的配置项\r\n * @returns\r\n */\r\n\r\nexport const useAsync = <D>(initialState?: State<D>, initialConfig?: typeof defaultConfig) => {\r\n    const config = { ...defaultConfig, ...initialConfig };\r\n    const [state, dispatch] = useReducer((state: State<D>, action: Partial<State<D>>) => ({ ...state, ...action }), {\r\n        ...defaultInitialState,\r\n        ...initialState,\r\n    });\r\n    const safeDispatch = useSafeDispatch(dispatch);\r\n    //useState保存函数不能直接传入函数，直接传入函数的意义：惰性初始化会立即执行该函数,并把返回值传给retry\r\n    //setRetry时也会执行函数并返回所以也要加一层层\r\n    const [retry, setRetry] = useState(() => () => {});\r\n    /**成功 */\r\n    const setData = useCallback(\r\n        (data: D) => {\r\n            safeDispatch({\r\n                data: data,\r\n                stat: \"success\",\r\n                error: null,\r\n            });\r\n        },\r\n        [safeDispatch]\r\n    );\r\n    /**失败 */\r\n    const setError = useCallback(\r\n        (error: Error) => {\r\n            safeDispatch({\r\n                error: error,\r\n                stat: \"error\",\r\n                data: null,\r\n            });\r\n        },\r\n        [safeDispatch]\r\n    );\r\n    /**\r\n     * 传入异步请求可以是useHttp里的请求，用来触发异步请求，并返回相关的请求信息,将相关信息赋值给state\r\n     * @param promise 异步请求后的promise\r\n     * @param runConfig run函数的配置参数\r\n     * @returns 返回一个promise\r\n     */\r\n    const run = useCallback(\r\n        (promise: Promise<D>, runConfig?: { retry: () => Promise<D> }) => {\r\n            if (!promise || !promise.then) {\r\n                throw new Error(\"请传入 promise 类型数据\");\r\n            }\r\n            //将每次的promise缓存起来\r\n            setRetry(() => () => {\r\n                if (runConfig?.retry) {\r\n                    run(runConfig?.retry(), runConfig);\r\n                }\r\n            });\r\n            safeDispatch({\r\n                stat: \"loading\",\r\n            });\r\n            return promise\r\n                .then((data) => {\r\n                    //如果组件挂载完成\r\n                    setData(data);\r\n                    return data;\r\n                })\r\n                .catch((error) => {\r\n                    //catch会自动消化异常，如果不主动抛出异常，外面的catch是捕获不到异常的\r\n                    setError(error);\r\n                    if (config.throwOnError) return Promise.reject(error);\r\n                    return error;\r\n                });\r\n        },\r\n        [config.throwOnError, setData, safeDispatch, setError]\r\n    );\r\n\r\n    return {\r\n        isIdle: state.stat === \"idle\",\r\n        isLoading: state.stat === \"loading\",\r\n        isError: state.stat === \"error\",\r\n        isSuccess: state.stat === \"success\",\r\n        run,\r\n        setData,\r\n        setError,\r\n        retry,\r\n        ...state,\r\n    };\r\n};\r\n","import styled from \"@emotion/styled\";\r\nimport { Button, Spin, Typography } from \"antd\";\r\nimport { DevTools } from \"jira-dev-tool\";\r\n/**\r\n *\r\n */\r\nexport const Row = styled.div<{\r\n    gap?: number | boolean; //\r\n    between?: boolean; //是否是 justify-content:between\r\n    marginBottom?: number;\r\n}>`\r\n    display: flex;\r\n    align-items: center;\r\n    margin-bottom: ${(props) => props.marginBottom + \"rem\"};\r\n    justify-content: ${(props) => (props.between ? \"space-between\" : undefined)};\r\n    > * {\r\n        margin-top: 0 !important;\r\n        margin-bottom: 0 !important;\r\n        margin-right: ${(props) => (typeof props.gap === \"number\" ? props.gap + \"rem\" : props.gap ? \"2rem\" : undefined)};\r\n    }\r\n`;\r\n/**全屏的加载中组件*/\r\nexport const FullPageLoading = () => {\r\n    return (\r\n        <FullPage>\r\n            <Spin size={\"large\"} />\r\n        </FullPage>\r\n    );\r\n};\r\nexport const FullPageErrorFallback = ({ error }: { error: Error | null }) => {\r\n    return (\r\n        <FullPage>\r\n            <DevTools />\r\n            <ErrorBox error={error} />\r\n        </FullPage>\r\n    );\r\n};\r\n\r\n//类型守卫，表示如果有message值,将value值类型设置为Error类型\r\nconst isError = (value: any): value is Error => value?.massage;\r\n/**过滤掉非Error类型的error */\r\nexport const ErrorBox = ({ error }: { error: unknown }) => {\r\n    if (isError(error)) {\r\n        return <Typography.Text type={\"danger\"}>{error?.message}</Typography.Text>;\r\n    }\r\n    return null;\r\n};\r\n\r\nexport const ButtonNoPadding = styled(Button)`\r\n    padding: 0;\r\n`;\r\nexport const ScreenContainer = styled.div`\r\n    padding: 3.2rem;\r\n    width: 100%;\r\n    display: flex;\r\n    flex-direction: column;\r\n`;\r\n\r\nconst FullPage = styled.div`\r\n    height: 100vh;\r\n    display: flex;\r\n    justify-content: center;\r\n    align-items: center;\r\n`;\r\n","import React, { ReactNode } from \"react\";\r\nimport * as auth from \"authProvider\";\r\nimport { http } from \"utils/http\";\r\nimport { useMount } from \"utils\";\r\nimport { useAsync } from \"utils/useAsync\";\r\nimport { useQueryClient } from \"react-query\";\r\nimport { FullPageErrorFallback, FullPageLoading } from \"components/lib\";\r\nimport { User } from \"types/user\";\r\ninterface AuthForm {\r\n    username: string;\r\n    password: string;\r\n}\r\nconst AuthContext = React.createContext<\r\n    | {\r\n          user: User | null;\r\n          register: (form: AuthForm) => Promise<void>;\r\n          login: (form: AuthForm) => Promise<void>;\r\n          loginOut: () => Promise<void>;\r\n      }\r\n    | undefined\r\n>(undefined);\r\nAuthContext.displayName = \"AuthContext\";\r\n\r\n/**初始化user */\r\nconst bootstrapUser = async () => {\r\n    let user = null;\r\n    const token = auth.getToken();\r\n    if (token) {\r\n        const data = await http(\"me\", { token });\r\n        user = data.user;\r\n    }\r\n    return user;\r\n};\r\nexport const AuthProvider = ({ children }: { children: ReactNode }) => {\r\n    const { run, data: user, setData: setUser, error, isLoading, isIdle, isError } = useAsync<User | null>();\r\n    const queryClient = useQueryClient();\r\n    const login = (form: AuthForm) => {\r\n        return auth.login(form).then((res) => {\r\n            setUser(res);\r\n        });\r\n    };\r\n    const register = (form: AuthForm) => {\r\n        return auth.register(form).then((res) => {\r\n            setUser(res);\r\n        });\r\n    };\r\n    const loginOut = () => {\r\n        return auth.loginOut().then((res) => {\r\n            setUser(null);\r\n            //登出的时候清除所有queryClient缓存的数据\r\n            queryClient.clear();\r\n        });\r\n    };\r\n    //初始化更新时候调用\r\n    useMount(() => {\r\n        run(bootstrapUser());\r\n    });\r\n    //加载中\r\n    if (isIdle || isLoading) {\r\n        return <FullPageLoading />;\r\n    }\r\n    //出现错误\r\n    if (isError) {\r\n        return <FullPageErrorFallback error={error} />;\r\n    }\r\n    return <AuthContext.Provider children={children} value={{ user, login, register, loginOut }} />;\r\n};\r\n\r\nexport const useAuth = () => {\r\n    const context = React.useContext(AuthContext);\r\n    if (!context) {\r\n        throw new Error(\"useAuth必须在AutoProvider中使用\");\r\n    }\r\n    return context;\r\n};\r\n","import { User } from \"types/user\";\r\nimport { clearObject } from \"utils\";\r\nimport { useHttp } from \"./http\";\r\nimport { useQuery } from \"react-query\";\r\n/**获取用户列表的hook */\r\n\r\nexport const useUsers = (param?: Partial<User>) => {\r\n    const client = useHttp();\r\n\r\n    return useQuery<User[], Error>([\"users\", param], () => client(`users`, { data: clearObject(param || {}) }));\r\n};\r\n","import { Select } from \"antd\";\r\nimport React from \"react\";\r\nimport { Raw } from \"types\";\r\n\r\n// 将原来的的Select中的所有属性提取出来和自定义组件的参数类型idSelectProps合并\r\ntype SelectProps = React.ComponentProps<typeof Select>;\r\n//继承SelectProps中的属性，Omit<SelectProps, \"value\" | \"onChange\" | \"options\">删除相同的使用项\r\ninterface idSelectProps extends Omit<SelectProps, \"value\" | \"onChange\" | \"options\"> {\r\n    value?: Raw | null | undefined; //option的value值\r\n    onChange?: (value?: number) => void; //change函数\r\n    defaultOptionName?: string; //第一项的默认值\r\n    options?: { name: string; id: number }[]; //要遍历的数组\r\n}\r\n/**\r\n * value 可以传入多种类型的值\r\n * onChange只会回调 number| undefined 类型的值\r\n * 当isNaN(Number(value)) 为true的时候，代表选择默认类型\r\n * 当选择默认类型的时候，onChange会回调undefined\r\n * @param props\r\n */\r\nexport const IdSelect = (props: idSelectProps) => {\r\n    const { value, onChange, defaultOptionName, options, ...restProps } = props;\r\n    return (\r\n        <Select\r\n            value={options?.length ? toNumber(value) : 0}\r\n            onChange={(value) => {\r\n                return onChange?.(toNumber(value) || undefined);\r\n            }}\r\n            {...restProps} //将Select中原先所有props封装到该组件里\r\n        >\r\n            {/* 默认项第一项 */}\r\n            {defaultOptionName ? <Select.Option value={0}>{defaultOptionName}</Select.Option> : null}\r\n            {options?.map((option) => {\r\n                return (\r\n                    <Select.Option key={option.id} value={option.id}>\r\n                        {option.name}\r\n                    </Select.Option>\r\n                );\r\n            })}\r\n        </Select>\r\n    );\r\n};\r\n/**判断是否能将value转成数字 如果可以返回转换后的数字否则返回0 */\r\nconst toNumber = (value: unknown) => (isNaN(Number(value)) ? 0 : Number(value));\r\n","import React from \"react\";\r\nimport { useUsers } from \"utils/useUsers\";\r\nimport { IdSelect } from \"./idSelect\";\r\nexport const UserSelect = (props: React.ComponentProps<typeof IdSelect>) => {\r\n    const { data: users } = useUsers();\r\n    return <IdSelect options={users || []} {...props} />;\r\n};\r\n","import React from \"react\";\r\nimport { Input } from \"antd\";\r\nimport { Form } from \"antd\";\r\n\r\nimport { UserSelect } from \"components/userSelect\";\r\nimport { Project } from \"types/project\";\r\nimport { User } from \"types/user\";\r\n\r\ninterface SearchPanelProps {\r\n    users: User[];\r\n    param: Partial<Pick<Project, \"name\" | \"personId\">>;\r\n    // param: {\r\n    //     name: string;\r\n    //     personId: number;\r\n    // };\r\n    setParam: (param: SearchPanelProps[\"param\"]) => void;\r\n}\r\nfunction SearchPanel({ param, setParam, users }: SearchPanelProps) {\r\n    return (\r\n        <Form style={{ marginBottom: \"2rem\" }} layout={\"inline\"}>\r\n            <Form.Item>\r\n                <Input\r\n                    placeholder={\"项目名\"}\r\n                    type=\"text\"\r\n                    value={param.name}\r\n                    onChange={(event) => {\r\n                        setParam({ ...param, name: event.target.value });\r\n                    }}\r\n                ></Input>\r\n            </Form.Item>\r\n            <Form.Item>\r\n                <UserSelect\r\n                    defaultOptionName={\"负责人\"}\r\n                    value={param.personId}\r\n                    onChange={(value) => {\r\n                        setParam({\r\n                            ...param,\r\n                            personId: value,\r\n                        });\r\n                    }}\r\n                />\r\n            </Form.Item>\r\n        </Form>\r\n    );\r\n}\r\nexport default SearchPanel;\r\n","import { Rate } from \"antd\";\r\nimport React from \"react\";\r\ninterface PinProps extends React.ComponentProps<typeof Rate> {\r\n    checked: boolean; //选中状态\r\n    onCheckedChange?: (checked: boolean) => void; //切换选中状态函数\r\n}\r\n/**封装antd rate */\r\nexport const Pin = (props: PinProps) => {\r\n    const { checked, onCheckedChange, ...restProps } = props; //让Pin组件具备透传功能\r\n    return <Rate count={1} value={checked ? 1 : 0} onChange={(num) => onCheckedChange?.(Boolean(num) ? true : false)} {...restProps}></Rate>;\r\n};\r\n","interface ReorderProps {\r\n    fromId: number;\r\n    referenceId: number;\r\n    type: \"after\" | \"before\";\r\n    list: { id: number }[];\r\n}\r\n/**\r\n * 在本地对排序进行乐观更新\r\n * @param fromId 要排序的项目的id\r\n * @param type 'before' | 'after'\r\n * @param referenceId 参照id\r\n * @param list 要排序的列表, 比如tasks, kanbans\r\n */\r\nexport const reorder = ({ fromId, referenceId, type, list }: ReorderProps) => {\r\n    const copiedList = [...list];\r\n    const moveItemIndex = copiedList.findIndex((item) => {\r\n        return item.id === fromId;\r\n    });\r\n    //当跨看板移动时，移到另一看板的最末处超出目标数组的原来的长度，referenceId就会为undefined\r\n    if (!referenceId) {\r\n        return insertAfter({\r\n            list: [...copiedList],\r\n            fromId: moveItemIndex,\r\n            toId: copiedList.length - 1,\r\n        });\r\n    }\r\n    //找到目标\r\n    const targetIndex = copiedList.findIndex((item) => {\r\n        return item.id === referenceId;\r\n    });\r\n    const insert = type === \"after\" ? insertAfter : insertBefore;\r\n    return insert({\r\n        list: [...copiedList],\r\n        fromId: moveItemIndex,\r\n        toId: targetIndex,\r\n    });\r\n};\r\n\r\n/**\r\n * 在list中将from放在to的前边  即fromId < toId,所选项往后前\r\n */\r\ninterface inserProps {\r\n    fromId: number;\r\n    toId: number;\r\n    list: unknown[];\r\n}\r\nconst insertBefore = ({ list, fromId, toId }: inserProps) => {\r\n    //获得to项\r\n    const toItem = list[toId];\r\n    //删除from项\r\n    const removedItem = list.splice(fromId, 1)[0];\r\n    //获得新的toIndex\r\n    const toIndex = list.indexOf(toItem);\r\n    list.splice(toIndex, 0, removedItem);\r\n    return list;\r\n};\r\n/**\r\n * 在list中将from放在to的后边  即fromId > toId,所选项往后放\r\n */\r\nconst insertAfter = ({ list, fromId, toId }: inserProps) => {\r\n    //获得to项\r\n    const toItem = list[toId];\r\n    //删除from项\r\n    const removedItem = list.splice(fromId, 1)[0];\r\n    //获得新的toIndex\r\n    const toIndex = list.indexOf(toItem);\r\n    //往后放需要注意前一项的index改变了\r\n    list.splice(toIndex + 1, 0, removedItem);\r\n    return list;\r\n};\r\n","import { QueryKey, useQueryClient } from \"react-query\";\r\nimport { Task } from \"types/task\";\r\nimport { reorder } from \"./reorder\";\r\n/**\r\n * 用于react-query optimistic update的配置\r\n * @param queryKey\r\n * @param callback\r\n */\r\nexport const useConfig = (queryKey: QueryKey, callback: (target: any, old?: any[]) => any[]) => {\r\n    const queryClient = useQueryClient();\r\n    return {\r\n        //会在上面useMutation发生就调用\r\n        async onMutate(target: any) {\r\n            //保存前一个值\r\n            const previousItems = queryClient.getQueryData(queryKey);\r\n            //对比乐观更新为新值\r\n            queryClient.setQueryData(queryKey, (old?: any[]) => {\r\n                // console.log(old)\r\n                return callback(target, old);\r\n            });\r\n            //返回前一个值，可以用于失败回滚，保存到context中\r\n            return { previousItems };\r\n        },\r\n        onSuccess: (data: any, variables: any, context: any) => {\r\n            console.log(\"onSuccess\");\r\n        },\r\n        onError(error: any, newItem: any, context: any) {\r\n            //api请求失败，从context中获取旧值，回滚\r\n            queryClient.setQueryData(queryKey, context.previousItems);\r\n        },\r\n        onSettled() {\r\n            queryClient.invalidateQueries(queryKey);\r\n        },\r\n    };\r\n};\r\n\r\n/**mutation的删除配置 */\r\nexport const useDeleteConfig = (queryKey: QueryKey) => {\r\n    return useConfig(queryKey, (target, old) => {\r\n        return old?.filter((item) => target.id !== item.id) || [];\r\n    });\r\n};\r\n/**mutation的编辑配置 */\r\nexport const useEditConfig = (queryKey: QueryKey) => {\r\n    return useConfig(queryKey, (target, old) => {\r\n        const array = old?.map((item) => (target.id === item.id ? { ...item, ...target } : item));\r\n        return array || [];\r\n    });\r\n};\r\n/**mutation的添加配置 */\r\nexport const useAddConfig = (queryKey: QueryKey) => {\r\n    return useConfig(queryKey, (target, old) => (old ? [...old, target] : []));\r\n};\r\n/**kanban排序的相关配置 */\r\nexport const useReorderKanbanConfig = (queryKey: QueryKey) => {\r\n    return useConfig(queryKey, (target, old) => {\r\n        return reorder({ list: old, ...target }) || [];\r\n    });\r\n};\r\n/**Task排序的相关配置 */\r\nexport const useReorderTaskConfig = (queryKey: QueryKey) => {\r\n    return useConfig(queryKey, (target, old) => {\r\n        const orderList = reorder({ list: old, ...target }) as Task[];\r\n        //匹配id,不管有没有跨看板都重新设置kanbanId\r\n        return orderList.map((item) => {\r\n            return item.id === target.fromId ? { ...item, kanbanId: target.toKanbanId } : item;\r\n        });\r\n    });\r\n};\r\n","import { clearObject } from \"utils\";\r\nimport { useHttp } from \"./http\";\r\nimport { useQuery, useMutation, QueryKey } from \"react-query\";\r\nimport { useAddConfig, useDeleteConfig, useEditConfig } from \"./useOptimisticOptions\";\r\nimport { Project } from \"types/project\";\r\n/**获取项目列表的hook */\r\nexport const useProjects = (param?: Partial<Project>) => {\r\n    const client = useHttp();\r\n\r\n    return useQuery<Project[], Error>([\"projects\", param], () => client(`projects`, { data: clearObject(param || {}) }));\r\n};\r\n\r\nexport const useText = (param?: Partial<Project>) => {\r\n    const client = useHttp();\r\n    return useQuery<Project[], Error>([\"test\", 5], () => client(`projects/1`));\r\n};\r\n\r\n/**编辑project数据，不定义参数是为了让Hook再最外层使用,返回mutate让该函数可以在最内层调用 */\r\nexport const useEditProject = (queryKey: QueryKey) => {\r\n    const client = useHttp();\r\n    return useMutation(\r\n        (params: Partial<Project>) =>\r\n            client(`projects/${params.id}`, {\r\n                data: params,\r\n                method: \"PATCH\",\r\n            }),\r\n        useEditConfig(queryKey)\r\n    );\r\n};\r\n/**添加project数据，不定义参数是为了让Hook再最外层使用,返回mutate让该函数可以在最内层调用 */\r\nexport const useAddProject = (queryKey: QueryKey) => {\r\n    const client = useHttp();\r\n    return useMutation(\r\n        (params: Partial<Project>) =>\r\n            client(`projects`, {\r\n                data: params,\r\n                method: \"POST\",\r\n            }),\r\n        useAddConfig(queryKey)\r\n    );\r\n};\r\n/**删除project */\r\nexport const useDeleteProject = (queryKey: QueryKey) => {\r\n    const client = useHttp();\r\n    return useMutation(\r\n        ({ id }: { id: number }) =>\r\n            client(`projects/${id}`, {\r\n                method: \"DELETE\",\r\n            }),\r\n        useDeleteConfig(queryKey)\r\n    );\r\n};\r\n/**\r\n * 获取项目的详情\r\n * @param id 项目的id\r\n */\r\nexport const useProject = (id?: number) => {\r\n    const client = useHttp();\r\n    return useQuery<Project>([\"project\", { id }], () => client(`projects/${id}`), {\r\n        enabled: Boolean(id),\r\n    });\r\n};\r\n","import { useMemo } from \"react\";\r\nimport { URLSearchParamsInit, useSearchParams } from \"react-router-dom\";\r\nimport { clearObject } from \"utils\";\r\n\r\n/**返回页面的url 指定键的参数值 */\r\nexport const useUrlQueryParam = <T extends string>(keys: T[]) => {\r\n    const [searchParams] = useSearchParams(); //获取url中的Params\r\n    const setSearchParams = useSetUrlSearchParams();\r\n    return [\r\n        //使用useMemo将reduce第一次返回的对象缓存起来，让useEffect更新时的依赖不变，否则会无限循环\r\n        useMemo(() => {\r\n            //返回一个对象\r\n            //表示返回的类型是{ 'string' : 'string'}的键值对\r\n            return keys.reduce((prev, key) => {\r\n                return { ...prev, [key]: searchParams.get(key) || \"\" };\r\n            }, {} as { [key in T]: string });\r\n            //eslint-disable-next-line react-hooks/exhaustive-deps\r\n        }, [searchParams]),\r\n        (params: Partial<{ [key in T]: unknown }>) => {\r\n            return setSearchParams(params);\r\n        },\r\n    ] as const; //返回tuple类型，里面的子类型不一样的时候要使用as const\r\n};\r\nexport const useSetUrlSearchParams = () => {\r\n    const [searchParams, setSearchParams] = useSearchParams(); //获取url中的Params\r\n    return (params: { [key in string]: unknown }) => {\r\n        const o = clearObject({ ...Object.fromEntries(searchParams), ...params }) as URLSearchParamsInit;\r\n        //通过input输入参数 将参数更新到url里\r\n        return setSearchParams(o);\r\n    };\r\n};\r\n","import { useMemo } from \"react\";\r\nimport { useSetUrlSearchParams, useUrlQueryParam } from \"utils/url\";\r\nimport { useProject } from \"utils/useProjects\";\r\n/**项目列表搜索的参数 */\r\nexport const useProjectSearchParams = () => {\r\n    const [param, setParam] = useUrlQueryParam([\"name\", \"personId\"]);\r\n    return [\r\n        useMemo(() => {\r\n            return { ...param, personId: Number(param.personId) || undefined };\r\n        }, [param]),\r\n        setParam,\r\n    ] as const;\r\n};\r\n\r\n/**使用url来管理ProjectModal的状态  */\r\nexport const useProjectModal = () => {\r\n    const [{ projectCreate }, setProjectCreate] = useUrlQueryParam([\"projectCreate\"]);\r\n    const [{ editingProjectId }, setEditingProjectId] = useUrlQueryParam([\"editingProjectId\"]);\r\n    const { data: editingProject, isLoading } = useProject(Number(editingProjectId));\r\n\r\n    const setUrlParams = useSetUrlSearchParams();\r\n    const open = () => setProjectCreate({ projectCreate: true });\r\n    const close = () => {\r\n        //将控制projectModal的参数设置为空\r\n        setUrlParams({ projectCreate: \"\", editingProjectId: \"\" });\r\n    };\r\n    const startEdit = (id: number) => {\r\n        setEditingProjectId({ editingProjectId: id });\r\n    };\r\n    return {\r\n        projectModalOpen: projectCreate === \"true\" || Boolean(editingProjectId),\r\n        open,\r\n        close,\r\n        startEdit,\r\n        editingProject,\r\n        isLoading,\r\n    };\r\n};\r\n\r\nexport const useProjectQueryKey = () => {\r\n    const [searchParams] = useProjectSearchParams();\r\n    return [\"projects\", searchParams];\r\n};\r\n","import React from \"react\";\r\nimport { Dropdown, Menu, Modal, Table, TableProps } from \"antd\";\r\nimport dayjs from \"dayjs\";\r\nimport { Link } from \"react-router-dom\";\r\nimport { Pin } from \"components/pin\";\r\nimport { useDeleteProject, useEditProject } from \"utils/useProjects\";\r\nimport { ButtonNoPadding } from \"components/lib\";\r\nimport { useProjectModal, useProjectQueryKey } from \"./utils\";\r\nimport { Project } from \"types/project\";\r\nimport { User } from \"types/user\";\r\n\r\n//这样可以将Table里的所有属性暴露给List,通过在使用List的时候传Table的属性就可以了\r\n//List新增users属性\r\ninterface ListProps extends TableProps<Project> {\r\n    users: User[];\r\n}\r\n//将传入的props先给users赋值，剩下的传给props\r\nfunction List({ users, ...props }: ListProps) {\r\n    const { mutate } = useEditProject(useProjectQueryKey());\r\n    const { mutate: deleteProject } = useDeleteProject(useProjectQueryKey());\r\n    const { startEdit } = useProjectModal();\r\n\r\n    //柯里化\r\n    const pinProject = (id: number) => (pin: boolean) => mutate({ id: id, pin });\r\n    const editProject = (id: number) => startEdit(id);\r\n    const comfirmDeleteProject = (id: number) => {\r\n        Modal.confirm({\r\n            title: \"确定删除这个项目吗？\",\r\n            content: \"点击确定删除\",\r\n            okText: \"确定\",\r\n            cancelText: \"取消\",\r\n            onOk() {\r\n                deleteProject({ id });\r\n            },\r\n        });\r\n    };\r\n    return (\r\n        <div>\r\n            <Table\r\n                // rowKey={(record) => record.id}\r\n                pagination={false}\r\n                columns={[\r\n                    {\r\n                        title() {\r\n                            return <Pin checked={true}></Pin>;\r\n                        },\r\n                        render(value, record) {\r\n                            return <Pin checked={record.pin} onCheckedChange={pinProject(record.id)}></Pin>;\r\n                        },\r\n                    },\r\n                    {\r\n                        title: \"名称\",\r\n                        sorter: (a, b) => a.name.localeCompare(b.name),\r\n                        render(value, record) {\r\n                            // Link to会默认用户访问当前路由的子路由\r\n                            return <Link to={String(record.id)}>{record.name}</Link>;\r\n                            // return <Link to={`/projects/${record.id}`}>{record.name}</Link>;\r\n                        },\r\n                    },\r\n                    { title: \"部门\", dataIndex: \"organization\" },\r\n                    {\r\n                        title: \"负责人\",\r\n                        render(value, record) {\r\n                            return <span>{users.find((user) => user.id === record.personId)?.name || \"未知\"}</span>;\r\n                        },\r\n                    },\r\n\r\n                    {\r\n                        title: \"创建时间\",\r\n                        render(value, record) {\r\n                            return <span>{record.created ? dayjs(record.created).format(\"YYYY-MM-DD\") : \"无\"}</span>;\r\n                        },\r\n                    },\r\n                    {\r\n                        render(value, record) {\r\n                            return (\r\n                                <Dropdown\r\n                                    overlay={\r\n                                        <Menu>\r\n                                            <Menu.Item key={\"edit\"} onClick={() => editProject(record.id)}>\r\n                                                编辑\r\n                                            </Menu.Item>\r\n                                            <Menu.Item key={\"delete\"} onClick={() => comfirmDeleteProject(record.id)}>\r\n                                                删除\r\n                                            </Menu.Item>\r\n                                        </Menu>\r\n                                    }\r\n                                >\r\n                                    <ButtonNoPadding type={\"link\"}>...</ButtonNoPadding>\r\n                                </Dropdown>\r\n                            );\r\n                        },\r\n                    },\r\n                ]}\r\n                {...props} //将剩下的props赋值给Table\r\n            />\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default List;\r\n","import React from \"react\";\r\nimport SearchPanel from \"./searchPanel\";\r\nimport List from \"./list\";\r\nimport { useDebounce, useDocumentTitle } from \"../../utils\";\r\nimport styled from \"@emotion/styled\";\r\nimport { useUsers } from \"utils/useUsers\";\r\nimport { useProjects } from \"utils/useProjects\";\r\nimport { useProjectModal, useProjectSearchParams } from \"./utils\";\r\nimport { ButtonNoPadding, ErrorBox, Row } from \"components/lib\";\r\nfunction ProjectListScreen() {\r\n    useDocumentTitle(\"项目列表\", false);\r\n    const [param, setParam] = useProjectSearchParams();\r\n    const { open } = useProjectModal();\r\n    const debounceParam = useDebounce(param, 2000);\r\n    const { isLoading, error, data: list } = useProjects(debounceParam);\r\n\r\n    const { data: users } = useUsers();\r\n    return (\r\n        <Container>\r\n            <Row between={true}>\r\n                <h1>项目列表</h1>\r\n                <ButtonNoPadding type={\"link\"} onClick={() => open()}>\r\n                    创建项目\r\n                </ButtonNoPadding>\r\n            </Row>\r\n            <SearchPanel param={param} setParam={setParam} users={users || []} />\r\n            <ErrorBox error={error} />\r\n            <List loading={isLoading} dataSource={list || []} users={users || []} />\r\n        </Container>\r\n    );\r\n}\r\nexport default ProjectListScreen;\r\n//使用why-did-you-render对页面进行错误跟踪\r\nProjectListScreen.whyDidYouRender = false;\r\nconst Container = styled.div`\r\n    padding: 3.2rem;\r\n`;\r\n","var _defs, _g;\n\nvar _excluded = [\"title\", \"titleId\"];\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport * as React from \"react\";\n\nfunction SvgSoftwareLogo(_ref, svgRef) {\n  var title = _ref.title,\n      titleId = _ref.titleId,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    viewBox: \"0 0 179 32\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    focusable: \"false\",\n    \"aria-hidden\": \"true\",\n    className: \"css-sq9aeg-Logo\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _defs || (_defs = /*#__PURE__*/React.createElement(\"defs\", null, /*#__PURE__*/React.createElement(\"linearGradient\", {\n    x1: \"97.6553341%\",\n    y1: \"35.6591143%\",\n    x2: \"37.202032%\",\n    y2: \"75.4891864%\",\n    id: \"uid392-1\"\n  }, /*#__PURE__*/React.createElement(\"stop\", {\n    stopColor: \"#0052CC\",\n    offset: \"7%\"\n  }), /*#__PURE__*/React.createElement(\"stop\", {\n    stopColor: \"#2684FF\",\n    offset: \"100%\"\n  })), /*#__PURE__*/React.createElement(\"linearGradient\", {\n    x1: \"8.43371138%\",\n    y1: \"60.1495759%\",\n    x2: \"64.1161517%\",\n    y2: \"23.5790285%\",\n    id: \"uid392-2\"\n  }, /*#__PURE__*/React.createElement(\"stop\", {\n    stopColor: \"#0052CC\",\n    offset: \"0%\"\n  }), /*#__PURE__*/React.createElement(\"stop\", {\n    stopColor: \"#2684FF\",\n    offset: \"100%\"\n  })))), _g || (_g = /*#__PURE__*/React.createElement(\"g\", {\n    stroke: \"none\",\n    strokeWidth: 1,\n    fillRule: \"nonzero\"\n  }, /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M11.3881081,27.9242105 C12.4881804,26.8071817 13.1062496,25.2917664 13.1062496,23.7115789 C13.1062496,22.1313915 12.4881804,20.6159762 11.3881081,19.4989474 L11.3881081,19.4989474 L3.74837838,11.7621053 L0.273513514,15.2926316 C-0.0900771727,15.6625064 -0.0900771727,16.2617042 0.273513514,16.6315789 L11.3881081,27.9242105 L11.3881081,27.9242105 Z\",\n    fill: \"currentColor\",\n    fillRule: \"nonzero\"\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M22.5027027,15.2926316 L11.3881081,4 L11.3881081,4 L11.3539189,4.03473684 L11.3539189,4.03473684 C9.08852466,6.36456187 9.09963243,10.1156459 11.3787838,12.4315789 L19.0247297,20.1652632 L22.5027027,16.6315789 C22.8662934,16.2617042 22.8662934,15.6625064 22.5027027,15.2926316 Z\",\n    fill: \"currentColor\",\n    fillRule: \"nonzero\"\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M11.3881081,12.4252632 C9.10895676,10.1093301 9.09784899,6.35824608 11.3632432,4.02842105 L3.43445946,12.0810526 L7.58067568,16.2936842 L11.3881081,12.4252632 Z\",\n    fill: \"url(#uid392-1)\",\n    fillRule: \"nonzero\"\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M15.1893243,15.6368421 L11.3881081,19.4989474 C12.4881804,20.6159762 13.1062496,22.1313915 13.1062496,23.7115789 C13.1062496,25.2917664 12.4881804,26.8071817 11.3881081,27.9242105 L19.3355405,19.8494737 L15.1893243,15.6368421 Z\",\n    fill: \"url(#uid392-2)\",\n    fillRule: \"nonzero\"\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M36.07,18.956 C36.07,20.646 35.394,21.842 33.418,21.842 C32.56,21.842 31.702,21.686 31,21.4 L31,23.662 C31.65,23.896 32.586,24.104 33.808,24.104 C37.032,24.104 38.41,21.946 38.41,18.8 L38.41,6.918 L36.07,6.918 L36.07,18.956 Z M41.894,7.568 C41.894,8.556 42.544,9.128 43.454,9.128 C44.364,9.128 45.014,8.556 45.014,7.568 C45.014,6.58 44.364,6.008 43.454,6.008 C42.544,6.008 41.894,6.58 41.894,7.568 Z M42.31,24 L44.546,24 L44.546,11 L42.31,11 L42.31,24 Z M47.926,24 L50.11,24 L50.11,16.33 C50.11,13.574 51.852,12.716 54.712,13.002 L54.712,10.818 C52.164,10.662 50.864,11.754 50.11,13.288 L50.11,11 L47.926,11 L47.926,24 Z M65.45,24 L65.45,21.66 C64.618,23.376 63.058,24.26 61.056,24.26 C57.598,24.26 55.856,21.322 55.856,17.5 C55.856,13.834 57.676,10.74 61.316,10.74 C63.214,10.74 64.67,11.598 65.45,13.288 L65.45,11 L67.686,11 L67.686,24 L65.45,24 Z M58.092,17.5 C58.092,20.62 59.34,22.18 61.654,22.18 C63.656,22.18 65.45,20.906 65.45,18.02 L65.45,16.98 C65.45,14.094 63.812,12.82 61.914,12.82 C59.392,12.82 58.092,14.484 58.092,17.5 Z M86.926,19.294 C86.926,16.226 84.898,15.056 81.284,14.146 C78.268,13.392 77.176,12.69 77.176,11.286 C77.176,9.726 78.502,8.946 80.738,8.946 C82.506,8.946 84.352,9.258 86.068,10.246 L86.068,7.906 C84.898,7.256 83.312,6.658 80.842,6.658 C76.864,6.658 74.836,8.634 74.836,11.286 C74.836,14.094 76.552,15.42 80.4,16.356 C83.65,17.136 84.586,17.942 84.586,19.45 C84.586,20.958 83.624,21.972 81.05,21.972 C78.788,21.972 76.344,21.374 74.758,20.542 L74.758,22.934 C76.084,23.61 77.618,24.26 80.92,24.26 C85.158,24.26 86.926,22.258 86.926,19.294 Z M95.09,24.26 C91.19,24.26 88.902,21.374 88.902,17.474 C88.902,13.574 91.19,10.74 95.09,10.74 C98.964,10.74 101.226,13.574 101.226,17.474 C101.226,21.374 98.964,24.26 95.09,24.26 Z M95.09,12.82 C92.308,12.82 91.086,15.004 91.086,17.474 C91.086,19.944 92.308,22.18 95.09,22.18 C97.846,22.18 99.042,19.944 99.042,17.474 C99.042,15.004 97.846,12.82 95.09,12.82 Z M106.92,9.622 C106.92,8.452 107.596,7.646 108.974,7.646 C109.494,7.646 109.988,7.698 110.378,7.776 L110.378,5.722 C109.988,5.618 109.546,5.514 108.87,5.514 C106.088,5.514 104.736,7.152 104.736,9.57 L104.736,11 L102.63,11 L102.63,13.08 L104.736,13.08 L104.736,24 L106.92,24 L106.92,13.08 L110.274,13.08 L110.274,11 L106.92,11 L106.92,9.622 Z M115.786,19.892 L115.786,13.08 L119.244,13.08 L119.244,11 L115.786,11 L115.786,8.244 L113.602,8.244 L113.602,11 L111.496,11 L111.496,13.08 L113.602,13.08 L113.602,19.944 C113.602,22.362 114.954,24 117.736,24 C118.412,24 118.854,23.896 119.244,23.792 L119.244,21.634 C118.854,21.712 118.36,21.816 117.84,21.816 C116.462,21.816 115.786,21.036 115.786,19.892 Z M125.432,24 L128.292,24 L130.528,17.708 L131.724,13.704 L132.92,17.708 L135.156,24 L138.016,24 L142.8,11 L140.33,11 L136.586,22.024 L132.79,11 L130.658,11 L126.862,22.024 L123.118,11 L120.648,11 L125.432,24 Z M153.538,24 L153.538,21.66 C152.706,23.376 151.146,24.26 149.144,24.26 C145.686,24.26 143.944,21.322 143.944,17.5 C143.944,13.834 145.764,10.74 149.404,10.74 C151.302,10.74 152.758,11.598 153.538,13.288 L153.538,11 L155.774,11 L155.774,24 L153.538,24 Z M146.18,17.5 C146.18,20.62 147.428,22.18 149.742,22.18 C151.744,22.18 153.538,20.906 153.538,18.02 L153.538,16.98 C153.538,14.094 151.9,12.82 150.002,12.82 C147.48,12.82 146.18,14.484 146.18,17.5 Z M159.154,24 L161.338,24 L161.338,16.33 C161.338,13.574 163.08,12.716 165.94,13.002 L165.94,10.818 C163.392,10.662 162.092,11.754 161.338,13.288 L161.338,11 L159.154,11 L159.154,24 Z M178.108,23.48 C177.042,24.052 175.404,24.26 174.078,24.26 C169.216,24.26 167.084,21.452 167.084,17.474 C167.084,13.548 169.268,10.74 173.22,10.74 C177.224,10.74 178.836,13.522 178.836,17.474 L178.836,18.488 L169.346,18.488 C169.658,20.698 171.088,22.128 174.156,22.128 C175.664,22.128 176.938,21.842 178.108,21.426 L178.108,23.48 Z M173.116,12.768 C170.75,12.768 169.554,14.302 169.32,16.564 L176.574,16.564 C176.444,14.146 175.352,12.768 173.116,12.768 Z\",\n    fill: \"inherit\",\n    fillRule: \"evenodd\"\n  }))));\n}\n\nvar ForwardRef = /*#__PURE__*/React.forwardRef(SvgSoftwareLogo);\nexport default __webpack_public_path__ + \"static/media/software-logo.8043cb5b.svg\";\nexport { ForwardRef as ReactComponent };","import { Task } from \"types/task\";\r\nimport { useHttp } from \"./http\";\r\nimport { useQuery, QueryKey, useMutation } from \"react-query\";\r\nimport { useAddConfig, useDeleteConfig, useEditConfig, useReorderTaskConfig } from \"./useOptimisticOptions\";\r\nimport { useDebounce } from \"utils\";\r\nimport { SortProps } from \"./kanban\";\r\n\r\n/**获取任务列表Hook */\r\nexport const useTasks = (param?: Partial<Task>) => {\r\n    const client = useHttp();\r\n    const debouncedParam = { ...param, name: useDebounce(param?.name, 200) };\r\n    return useQuery<Task[], Error>([\"tasks\", param], () => client(`tasks`, { data: debouncedParam }));\r\n};\r\n\r\n/**\r\n * 添加Task\r\n * @param queryKey\r\n * @returns\r\n */\r\nexport const useAddTask = (queryKey: QueryKey) => {\r\n    const client = useHttp();\r\n    return useMutation(\r\n        (params: Partial<Task>) =>\r\n            client(`tasks`, {\r\n                data: params,\r\n                method: \"POST\",\r\n            }),\r\n        useAddConfig(queryKey)\r\n    );\r\n};\r\n\r\n/**获取task详情 */\r\nexport const useTask = (id: number) => {\r\n    const client = useHttp();\r\n    return useQuery([\"task\", { id }], () => client(`tasks/${id}`), {\r\n        enabled: Boolean(id),\r\n    });\r\n};\r\n\r\n/**编辑task */\r\nexport const useEditTask = (queryKey: QueryKey) => {\r\n    const client = useHttp();\r\n    return useMutation(\r\n        (params: Partial<Task>) =>\r\n            client(`tasks/${params.id}`, {\r\n                data: params,\r\n                method: \"PATCH\",\r\n            }),\r\n        useEditConfig(queryKey)\r\n    );\r\n};\r\n/**删除task */\r\nexport const useDeleteTask = (queryKey: QueryKey) => {\r\n    const client = useHttp();\r\n    return useMutation(\r\n        (params: Partial<Task>) =>\r\n            client(`tasks/${params.id}`, {\r\n                data: params,\r\n                method: \"DELETE\",\r\n            }),\r\n        useDeleteConfig(queryKey)\r\n    );\r\n};\r\n\r\n/**看板下的task排序 */\r\nexport const useReorderTask = (queryKey: QueryKey) => {\r\n    const client = useHttp();\r\n    return useMutation((params: SortProps) => {\r\n        return client(`tasks/reorder`, {\r\n            data: params,\r\n            method: \"POST\",\r\n        });\r\n    }, useReorderTaskConfig(queryKey));\r\n};\r\n","import { useCallback, useMemo } from \"react\";\r\nimport { useLocation } from \"react-router\";\r\nimport { useTask } from \"utils/task\";\r\nimport { useUrlQueryParam } from \"utils/url\";\r\nimport { useProject } from \"utils/useProjects\";\r\n\r\n/**从url中获取项目id */\r\nexport const useProjectIdInUrl = () => {\r\n    const { pathname } = useLocation();\r\n    const id = pathname.match(/projects\\/(\\d+)/)?.[1];\r\n    return Number(id);\r\n};\r\n\r\n/**使用项目id获取项目列表 */\r\nexport const useProjectInUrl = () => {\r\n    return useProject(useProjectIdInUrl());\r\n};\r\n\r\nexport const useKanbanSearchParams = () => ({ projectId: useProjectIdInUrl() });\r\n\r\n/**kanban的queryKey */\r\nexport const useKanbanQuerykey = () => [\"kanbans\", useKanbanSearchParams()];\r\n\r\nexport const useTasksSearchParams = () => {\r\n    const [param, setParam] = useUrlQueryParam([\"name\", \"typeId\", \"processorId\", \"tagId\"]);\r\n    const projectId = useProjectIdInUrl();\r\n\r\n    return useMemo(() => {\r\n        return {\r\n            projectId: projectId,\r\n            typeId: Number(param.typeId) || undefined,\r\n            processorId: Number(param.processorId) || undefined,\r\n            tagId: Number(param.tagId) || undefined,\r\n            name: param.name,\r\n        };\r\n    }, [projectId, param]);\r\n};\r\n/**task的query缓存 */\r\nexport const useTasksQueryKey = () => [\"tasks\", useTasksSearchParams()];\r\n\r\n/**管理modal的状态 */\r\nexport const useTasksModal = () => {\r\n    const [{ editingTaskId }, setEditingTaskId] = useUrlQueryParam([\"editingTaskId\"]);\r\n    //获取当前点击的Task数据\r\n    const { data: editingTask, isLoading } = useTask(Number(editingTaskId));\r\n    /**打开modal */\r\n    const startEdit = useCallback(\r\n        (id: number) => {\r\n            setEditingTaskId({ editingTaskId: id });\r\n        },\r\n        [setEditingTaskId]\r\n    );\r\n    /**关闭modal */\r\n    const close = useCallback(() => {\r\n        setEditingTaskId({ editingTaskId: \"\" });\r\n    }, [setEditingTaskId]);\r\n    return {\r\n        editingTaskId,\r\n        editingTask,\r\n        startEdit,\r\n        close,\r\n        isLoading,\r\n    };\r\n};\r\n","import { useProjectIdInUrl } from \"screens/kanban/util\";\r\n\r\nexport const useEpicSearchParams = () => ({ projectId: useProjectIdInUrl() });\r\n\r\n/**Epic的queryKey */\r\nexport const useEpicQuerykey = () => [\"epics\", useEpicSearchParams()];\r\n","import styled from \"@emotion/styled\";\r\nimport { Button, Drawer, DrawerProps, Form, Input, Spin } from \"antd\";\r\nimport { useForm } from \"antd/lib/form/Form\";\r\nimport { ErrorBox } from \"components/lib\";\r\nimport { useEffect } from \"react\";\r\nimport { useProjectIdInUrl } from \"screens/kanban/util\";\r\nimport { useAddEpic } from \"utils/epic\";\r\nimport { useEpicQuerykey } from \"./util\";\r\n\r\ntype createEpicProps = Pick<DrawerProps, \"visible\"> & { onClose: () => void };\r\nexport const CreateEpic = (props: createEpicProps) => {\r\n    const { mutate: addEpic, isLoading, error } = useAddEpic(useEpicQuerykey());\r\n    const projectId = useProjectIdInUrl();\r\n    const [form] = useForm();\r\n    const onFinish = async (values: any) => {\r\n        await addEpic({ ...values, projectId: projectId });\r\n        props.onClose();\r\n    };\r\n    useEffect(() => {\r\n        form.resetFields();\r\n    }, [form, props.visible]);\r\n    return (\r\n        <Drawer visible={props.visible} onClose={props.onClose} forceRender={true} destroyOnClose={true} width={\"100%\"}>\r\n            <Container>\r\n                {isLoading ? <Spin size={\"large\"} /> : <h1>创建任务组</h1>}\r\n                <ErrorBox error={error} />\r\n                <Form form={form} layout={\"vertical\"} style={{ width: \"40rem\" }} onFinish={onFinish}>\r\n                    <Form.Item label={\"名称\"} name={\"name\"} rules={[{ required: true, message: \"请输入任务组名称\" }]}>\r\n                        <Input placeholder={\"请输入任务组名称\"} />\r\n                    </Form.Item>\r\n\r\n                    <Form.Item style={{ textAlign: \"right\" }}>\r\n                        <Button loading={isLoading} type={\"primary\"} htmlType={\"submit\"}>\r\n                            提交\r\n                        </Button>\r\n                    </Form.Item>\r\n                </Form>\r\n            </Container>\r\n        </Drawer>\r\n    );\r\n};\r\n\r\nconst Container = styled.div`\r\n    height: 80vh;\r\n    display: flex;\r\n    flex-direction: column;\r\n    justify-content: center;\r\n    align-items: center;\r\n`;\r\n","import { Epic } from \"types/epic\";\r\nimport { useHttp } from \"./http\";\r\nimport { useQuery, useMutation, QueryKey } from \"react-query\";\r\nimport { useAddConfig, useDeleteConfig, useEditConfig } from \"./useOptimisticOptions\";\r\n\r\n/**获取看板列表Hook */\r\nexport const useEpics = (param?: Partial<Epic>) => {\r\n    const client = useHttp();\r\n    return useQuery<Epic[], Error>([\"epics\", param], () => client(`epics`, { data: param }));\r\n};\r\n\r\n/**\r\n * 用户添加任務組\r\n * @param queryKey\r\n * @returns\r\n */\r\nexport const useAddEpic = (queryKey: QueryKey) => {\r\n    const client = useHttp();\r\n    return useMutation(\r\n        (params: Partial<Epic>) =>\r\n            client(`epics`, {\r\n                data: params,\r\n                method: \"POST\",\r\n            }),\r\n        useAddConfig(queryKey)\r\n    );\r\n};\r\n\r\n/**删除任務組 */\r\nexport const useDeleteEpic = (queryKey: QueryKey) => {\r\n    const client = useHttp();\r\n    return useMutation(\r\n        (params: Partial<Epic>) =>\r\n            client(`epics/${params.id}`, {\r\n                data: params,\r\n                method: \"DELETE\",\r\n            }),\r\n        useDeleteConfig(queryKey)\r\n    );\r\n};\r\n","import { Row, ScreenContainer } from \"components/lib\";\r\nimport React from \"react\";\r\nimport { useProjectInUrl } from \"screens/kanban/util\";\r\nimport { Button, List, Modal } from \"antd\";\r\nimport { useDeleteEpic, useEpics } from \"utils/epic\";\r\nimport { useEpicQuerykey, useEpicSearchParams } from \"./util\";\r\nimport dayjs from \"dayjs\";\r\nimport { useTasks } from \"utils/task\";\r\nimport { Link } from \"react-router-dom\";\r\nimport { CreateEpic } from \"./createEpic\";\r\nimport { useState } from \"react\";\r\nimport { Epic } from \"types/epic\";\r\nexport const EpicScreen = () => {\r\n    const { data: currentProject } = useProjectInUrl();\r\n    const { data: epics } = useEpics(useEpicSearchParams());\r\n    const { data: tasks } = useTasks({ projectId: currentProject?.id });\r\n    const { mutate: deleteEpic } = useDeleteEpic(useEpicQuerykey());\r\n    const [epicCreateOpen, setEpicCreateOpen] = useState(false);\r\n    const startDelete = (epic: Epic) => {\r\n        Modal.confirm({\r\n            okText: \"确定\",\r\n            cancelText: \"取消\",\r\n            title: `确定删除任务组：${epic.name}`,\r\n            onOk() {\r\n                deleteEpic({ id: epic.id });\r\n            },\r\n        });\r\n    };\r\n    return (\r\n        <ScreenContainer>\r\n            <Row between={true}>\r\n                <h1>{currentProject?.name}任务组</h1>\r\n                <Button onClick={() => setEpicCreateOpen(true)} type={\"link\"}>\r\n                    创建任务组\r\n                </Button>\r\n            </Row>\r\n\r\n            <List\r\n                style={{ overflowY: \"scroll\", overflowX: \"hidden\" }}\r\n                dataSource={epics}\r\n                itemLayout={\"vertical\"}\r\n                renderItem={(epic) => {\r\n                    return (\r\n                        <List.Item>\r\n                            <List.Item.Meta\r\n                                title={\r\n                                    <Row between={true}>\r\n                                        <span>{epic.name}</span>\r\n                                        <Button onClick={() => startDelete(epic)} type={\"link\"}>\r\n                                            刪除\r\n                                        </Button>\r\n                                    </Row>\r\n                                }\r\n                                description={\r\n                                    <div>\r\n                                        <div>开始時间：{dayjs(epic.start).format(\"YYYY-MM-DD\")}</div>\r\n                                        <div>开始時间：{dayjs(epic.end).format(\"YYYY-MM-DD\")}</div>\r\n                                    </div>\r\n                                }\r\n                            />\r\n                            <div>\r\n                                {tasks\r\n                                    ?.filter((task) => task.epicId === epic.id)\r\n                                    .map((task) => {\r\n                                        return (\r\n                                            <div>\r\n                                                <Link to={`/projects/${currentProject?.id}/kanban?editingTaskId=${task.id}`} key={task.id}>\r\n                                                    {task.name}\r\n                                                </Link>\r\n                                            </div>\r\n                                        );\r\n                                    })}\r\n                            </div>\r\n                        </List.Item>\r\n                    );\r\n                }}\r\n            />\r\n            <CreateEpic onClose={() => setEpicCreateOpen(false)} visible={epicCreateOpen} />\r\n        </ScreenContainer>\r\n    );\r\n};\r\n","import { Kanban } from \"types/kanban\";\r\nimport { useHttp } from \"./http\";\r\nimport { useQuery, useMutation, QueryKey } from \"react-query\";\r\nimport { useAddConfig, useDeleteConfig, useReorderKanbanConfig } from \"./useOptimisticOptions\";\r\n\r\n/**获取看板列表Hook */\r\nexport const useKanbans = (param?: Partial<Kanban>) => {\r\n    const client = useHttp();\r\n    return useQuery<Kanban[], Error>([\"kanbans\", param], () => client(`kanbans`, { data: param }));\r\n};\r\n\r\n/**\r\n * 用户添加看板\r\n * @param queryKey\r\n * @returns\r\n */\r\nexport const useAddKanban = (queryKey: QueryKey) => {\r\n    const client = useHttp();\r\n    return useMutation(\r\n        (params: Partial<Kanban>) =>\r\n            client(`kanbans`, {\r\n                data: params,\r\n                method: \"POST\",\r\n            }),\r\n        useAddConfig(queryKey)\r\n    );\r\n};\r\n\r\n/**删除看板 */\r\nexport const useDeleteKanban = (queryKey: QueryKey) => {\r\n    const client = useHttp();\r\n    return useMutation(\r\n        (params: Partial<Kanban>) =>\r\n            client(`kanbans/${params.id}`, {\r\n                data: params,\r\n                method: \"DELETE\",\r\n            }),\r\n        useDeleteConfig(queryKey)\r\n    );\r\n};\r\n\r\nexport interface SortProps {\r\n    //要重新排序的item\r\n    fromId: number;\r\n    //目标的位置\r\n    referenceId: number;\r\n    //放的类型，前还是后\r\n    type: \"before\" | \"after\";\r\n    //始kanban\r\n    fromKanbanId?: number;\r\n    //终kanban\r\n    toKanbanId?: number;\r\n}\r\nexport const useReorderKanban = (queryKey: QueryKey) => {\r\n    const client = useHttp();\r\n    return useMutation((params: SortProps) => {\r\n        return client(`kanbans/reorder`, {\r\n            data: params,\r\n            method: \"POST\",\r\n        });\r\n    }, useReorderKanbanConfig(queryKey));\r\n};\r\n","import { TaskType } from \"types/taskType\";\r\nimport { useHttp } from \"./http\";\r\nimport { useQuery } from \"react-query\";\r\n\r\n/**获取任务列表Hook */\r\nexport const useTaskTypes = (param?: Partial<TaskType>) => {\r\n    const client = useHttp();\r\n    return useQuery<TaskType[], Error>([\"taskTypes\", param], () => client(`taskTypes`));\r\n};\r\n","export default __webpack_public_path__ + \"static/media/bug.bc7dca9d.svg\";","export default __webpack_public_path__ + \"static/media/task.8118694e.svg\";","import { Card, Input } from \"antd\";\r\nimport { useEffect } from \"react\";\r\nimport { useState } from \"react\";\r\nimport { useAddTask } from \"utils/task\";\r\nimport { useProjectIdInUrl, useTasksQueryKey } from \"./util\";\r\n\r\nexport const CreateTask = ({ kanbanId }: { kanbanId: number }) => {\r\n    const [name, setName] = useState(\"\");\r\n    const { mutateAsync: addTask } = useAddTask(useTasksQueryKey());\r\n    const projectId = useProjectIdInUrl();\r\n    const [inputMode, setInputMode] = useState(false);\r\n\r\n    const submit = async () => {\r\n        await addTask({ projectId, name, kanbanId });\r\n        setInputMode(false);\r\n        setName(\"\");\r\n    };\r\n    /**切换显示的输入状态 */\r\n    const toggle = () => {\r\n        setInputMode((mode) => {\r\n            return !mode;\r\n        });\r\n    };\r\n    useEffect(() => {\r\n        if (!inputMode) {\r\n            setName(\"\");\r\n        }\r\n    }, [inputMode]);\r\n    if (!inputMode) {\r\n        return <div onClick={toggle}>+创建事务</div>;\r\n    }\r\n    return (\r\n        <Card>\r\n            <Input onPressEnter={submit} onBlur={toggle} placeholder={\"需要做些什么\"} autoFocus={true} value={name} onChange={(evt) => setName(evt.target.value)} />\r\n        </Card>\r\n    );\r\n};\r\n","interface MarkProps {\r\n    name: string;\r\n    keyWord: string;\r\n}\r\nexport const Mark = ({ name, keyWord }: MarkProps) => {\r\n    if (!keyWord) {\r\n        return <>{name}</>;\r\n    }\r\n    const arr = name.split(keyWord);\r\n    return (\r\n        <>\r\n            {arr.map((str, index) => {\r\n                return (\r\n                    <span key={index}>\r\n                        {str}\r\n                        {index === arr.length - 1 ? null : <span style={{ color: \"#257AFD\" }}>{keyWord}</span>}\r\n                    </span>\r\n                );\r\n            })}\r\n        </>\r\n    );\r\n};\r\n","import React, { ReactNode } from \"react\";\r\nimport { Draggable, DraggableProps, Droppable, DroppableProps, DroppableProvided, DroppableProvidedProps } from \"react-beautiful-dnd\";\r\ntype DropProps = Omit<DroppableProps, \"children\"> & { children: ReactNode };\r\n/**对react-beautiful-dnd进行封装 */\r\nexport const Drop = ({ children, ...props }: DropProps) => {\r\n    return (\r\n        <Droppable {...props}>\r\n            {(provided) => {\r\n                if (React.isValidElement(children)) {\r\n                    return React.cloneElement(children, {\r\n                        ...provided.droppableProps,\r\n                        ref: provided.innerRef,\r\n                        provided,\r\n                    });\r\n                }\r\n                return <div />;\r\n            }}\r\n        </Droppable>\r\n    );\r\n};\r\n\r\ntype DropChildProps = Partial<{ provided: DroppableProvided } & DroppableProvidedProps> & React.HTMLAttributes<HTMLDivElement>;\r\n// Drop的子组件\r\n// 使用forwardRef进行ref转发，让用户在使用DropChild的时候，可以<DropChild ref={ref}/>\r\nexport const DropChild = React.forwardRef<HTMLDivElement, DropChildProps>(({ children, ...props }, ref) => (\r\n    <div ref={ref} {...props}>\r\n        {children}\r\n        {props.provided?.placeholder}\r\n    </div>\r\n));\r\ntype DragProps = Omit<DraggableProps, \"children\"> & { children: React.ReactNode };\r\nexport const Drag = ({ children, ...props }: DragProps) => {\r\n    return (\r\n        <Draggable {...props}>\r\n            {(provided) => {\r\n                if (React.isValidElement(children)) {\r\n                    return React.cloneElement(children, {\r\n                        ...provided.draggableProps,\r\n                        ...provided.dragHandleProps,\r\n                        ref: provided.innerRef,\r\n                    });\r\n                }\r\n                return <div />;\r\n            }}\r\n        </Draggable>\r\n    );\r\n};\r\n","import React from \"react\";\r\nimport { Kanban } from \"types/kanban\";\r\nimport { useTasks } from \"utils/task\";\r\nimport { useTaskTypes } from \"utils/taskType\";\r\nimport { useTasksSearchParams, useTasksModal, useKanbanQuerykey } from \"./util\";\r\nimport bugIcon from \"assets/bug.svg\";\r\nimport taskIcon from \"assets/task.svg\";\r\nimport styled from \"@emotion/styled\";\r\nimport { Button, Card, Dropdown, Menu, Modal } from \"antd\";\r\nimport { CreateTask } from \"./createTask\";\r\nimport { Task } from \"types/task\";\r\nimport { Mark } from \"components/mark\";\r\nimport { useDeleteKanban } from \"utils/kanban\";\r\nimport { Row } from \"components/lib\";\r\nimport { Drag, Drop, DropChild } from \"components/dragAndDrop\";\r\n\r\nexport const TaskTypeIcon = ({ id }: { id: number }) => {\r\n    const { data: taskTypes } = useTaskTypes();\r\n    const name = taskTypes?.find((taskType) => taskType.id === id)?.name;\r\n    if (!name) {\r\n        return null;\r\n    }\r\n    return <img alt={\"task-icon\"} src={name === \"task\" ? taskIcon : bugIcon} />;\r\n};\r\n\r\nconst More = ({ kanban }: KanbanProps) => {\r\n    const { mutateAsync } = useDeleteKanban(useKanbanQuerykey());\r\n    const startEdit = () => {\r\n        Modal.confirm({\r\n            okText: \"确定\",\r\n            cancelText: \"取消\",\r\n            title: \"确定删除看板吗\",\r\n            onOk() {\r\n                mutateAsync({ id: kanban.id });\r\n            },\r\n        });\r\n    };\r\n    const overlay = (\r\n        <Menu>\r\n            <Menu.Item>\r\n                <Button type={\"link\"} onClick={startEdit}>\r\n                    删除\r\n                </Button>\r\n            </Menu.Item>\r\n        </Menu>\r\n    );\r\n    return (\r\n        <Dropdown overlay={overlay}>\r\n            <Button type={\"link\"}>...</Button>\r\n        </Dropdown>\r\n    );\r\n};\r\n\r\ninterface TaskCardProps {\r\n    task: Task;\r\n}\r\n// 使用react.forwardof 对传入KanbanColumn的ref进行透传\r\nconst TaskCard = React.forwardRef<HTMLDivElement, TaskCardProps>(({ task, ...props }, ref) => {\r\n    const { startEdit } = useTasksModal();\r\n    const { name: keyWord } = useTasksSearchParams();\r\n    return (\r\n        <div ref={ref} {...props}>\r\n            <Card onClick={() => startEdit(task.id)} style={{ marginBottom: \"0.5rem\", cursor: \"pointer\" }} key={task.id}>\r\n                <p>\r\n                    <Mark keyWord={keyWord} name={task.name} />\r\n                </p>\r\n                <TaskTypeIcon id={task.typeId} />\r\n            </Card>\r\n        </div>\r\n    );\r\n});\r\n\r\ninterface KanbanProps {\r\n    kanban: Kanban;\r\n}\r\n// 使用react.forwardof 对传入KanbanColumn的ref进行透传\r\nexport const KanbanColumn = React.forwardRef<HTMLDivElement, KanbanProps>(({ kanban, ...props }, ref) => {\r\n    const { data: allTasks } = useTasks(useTasksSearchParams());\r\n    const tasks = allTasks?.filter((task) => {\r\n        return task.kanbanId === kanban.id;\r\n    });\r\n    return (\r\n        <Container {...props} ref={ref}>\r\n            <Row between>\r\n                <h3>{kanban.name}</h3>\r\n                <More kanban={kanban} key={kanban.id} />\r\n            </Row>\r\n\r\n            <TaskContainer>\r\n                <Drop type={\"ROW\"} droppableId={String(kanban.id)} direction={\"vertical\"}>\r\n                    <DropChild style={{ minHeight: \"5px\" }}>\r\n                        {tasks?.map((task, taskIndex) => {\r\n                            return (\r\n                                <Drag index={taskIndex} key={task.id} draggableId={\"task\" + task.id}>\r\n                                    <TaskCard key={task.id} task={task} />\r\n                                </Drag>\r\n                            );\r\n                        })}\r\n                    </DropChild>\r\n                </Drop>\r\n                <CreateTask kanbanId={kanban.id} />\r\n            </TaskContainer>\r\n        </Container>\r\n    );\r\n});\r\n\r\nexport const Container = styled.div`\r\n    min-width: 27rem;\r\n    border-radius: 6px;\r\n    background-color: rgb(244, 245, 247);\r\n    display: flex;\r\n    flex-direction: column;\r\n    padding: 0.7rem 0.7rem 1rem;\r\n    margin-right: 1.5rem;\r\n`;\r\n\r\nconst TaskContainer = styled.div`\r\n    overflow: scroll;\r\n    flex: 1;\r\n    ::-webkit-scrollbar {\r\n        display: none;\r\n    }\r\n`;\r\n","import { Input } from \"antd\";\r\nimport { useState } from \"react\";\r\nimport { useAddKanban } from \"utils/kanban\";\r\nimport { Container } from \"./kanbanColumn\";\r\nimport { useKanbanQuerykey, useProjectIdInUrl } from \"./util\";\r\n\r\nexport const CreateKanban = () => {\r\n    const [name, setName] = useState(\"\");\r\n    const projectId = useProjectIdInUrl();\r\n    const { mutateAsync: addKanban } = useAddKanban(useKanbanQuerykey());\r\n    const submit = async () => {\r\n        await addKanban({ name, projectId });\r\n        setName(\"\");\r\n    };\r\n    return (\r\n        <Container>\r\n            <Input size={\"large\"} placeholder={\"新建看板名称\"} value={name} onChange={(evt) => setName(evt.target.value)} onPressEnter={submit}></Input>\r\n        </Container>\r\n    );\r\n};\r\n","import React from \"react\";\r\nimport { useTaskTypes } from \"utils/taskType\";\r\nimport { IdSelect } from \"./idSelect\";\r\nexport const TaskTypeSelect = (props: React.ComponentProps<typeof IdSelect>) => {\r\n    const { data: taskTypes } = useTaskTypes();\r\n    return <IdSelect options={taskTypes || []} {...props} />;\r\n};\r\n","import { Input } from \"antd\";\r\nimport { Button } from \"antd/lib/radio\";\r\nimport { Row } from \"components/lib\";\r\nimport { TaskTypeSelect } from \"components/taskTypeSelect\";\r\nimport { UserSelect } from \"components/userSelect\";\r\nimport React from \"react\";\r\nimport { useSetUrlSearchParams } from \"utils/url\";\r\nimport { useTasksSearchParams } from \"./util\";\r\nexport const SearchPanel = () => {\r\n    const searchParams = useTasksSearchParams();\r\n    const setSearchParams = useSetUrlSearchParams();\r\n    const reset = () => {\r\n        setSearchParams({\r\n            typeId: undefined,\r\n            processorId: undefined,\r\n            tagId: undefined,\r\n            name: undefined,\r\n        });\r\n    };\r\n    return (\r\n        <Row marginBottom={4} gap={true}>\r\n            <Input style={{ width: \"20rem\" }} placeholder={\"任务名称\"} value={searchParams.name} onChange={(evt) => setSearchParams({ name: evt.target.value })}></Input>\r\n            <UserSelect\r\n                defaultOptionName={\"经办人\"}\r\n                value={searchParams.processorId}\r\n                onChange={(value) => {\r\n                    setSearchParams({ processorId: value });\r\n                }}\r\n            />\r\n            <TaskTypeSelect\r\n                defaultOptionName={\"类型\"}\r\n                value={searchParams.typeId}\r\n                onChange={(value) =>\r\n                    setSearchParams({\r\n                        typeId: value,\r\n                    })\r\n                }\r\n            />\r\n            <Button type={\"\"} onClick={reset}>\r\n                清除筛选器\r\n            </Button>\r\n        </Row>\r\n    );\r\n};\r\n","import { useForm } from \"antd/lib/form/Form\";\r\nimport { Button, Form, Input } from \"antd\";\r\nimport { Modal } from \"antd\";\r\nimport { useEffect } from \"react\";\r\nimport { useDeleteTask, useEditTask } from \"utils/task\";\r\nimport { useTasksQueryKey, useTasksModal } from \"./util\";\r\nimport { UserSelect } from \"components/userSelect\";\r\nimport { TaskTypeSelect } from \"components/taskTypeSelect\";\r\nconst layout = {\r\n    labelCol: { span: 8 },\r\n    wrapperCol: { span: 16 },\r\n};\r\n\r\nexport const TaskModal = () => {\r\n    const [form] = useForm();\r\n    const { editingTaskId, editingTask, close } = useTasksModal();\r\n    const { mutateAsync: editTask, isLoading: editLoading } = useEditTask(useTasksQueryKey());\r\n    const { mutateAsync: deleteTask } = useDeleteTask(useTasksQueryKey());\r\n    /**model取消 */\r\n    const onCancel = () => {\r\n        form.resetFields();\r\n        close();\r\n    };\r\n    /**modal确定 */\r\n    const onOk = async () => {\r\n        await editTask({ ...editingTask, ...form.getFieldsValue() });\r\n        close();\r\n    };\r\n    /**删除当前task */\r\n    const startDelete = () => {\r\n        Modal.confirm({\r\n            okText: \"确定\",\r\n            cancelText: \"取消\",\r\n            title: \"确定删除任务吗\",\r\n            onOk() {\r\n                deleteTask({ id: Number(editingTaskId) });\r\n            },\r\n        });\r\n    };\r\n    useEffect(() => {\r\n        form.setFieldsValue(editingTask);\r\n    }, [form, editingTask]);\r\n    return (\r\n        <Modal forceRender={true} onCancel={onCancel} onOk={onOk} visible={!!editingTaskId} title={\"编辑任务\"} confirmLoading={editLoading} okText={\"确认\"} cancelText={\"取消\"}>\r\n            <Form {...layout} initialValues={editingTask} form={form}>\r\n                <Form.Item label={\"任务名称\"} name={\"name\"} rules={[{ required: true, message: \"请输入任务名称\" }]}>\r\n                    <Input />\r\n                </Form.Item>\r\n                <Form.Item label={\"经办人\"} name={\"processorId\"}>\r\n                    <UserSelect defaultOptionName={\"经办人\"} />\r\n                </Form.Item>\r\n                <Form.Item label={\"类型\"} name={\"typeId\"}>\r\n                    <TaskTypeSelect />\r\n                </Form.Item>\r\n            </Form>\r\n            <div style={{ textAlign: \"right\" }}>\r\n                <Button onClick={startDelete} style={{ fontSize: \"14px\" }} size={\"small\"}>\r\n                    删除\r\n                </Button>\r\n            </div>\r\n        </Modal>\r\n    );\r\n};\r\n","import styled from \"@emotion/styled\";\r\nimport { Spin } from \"antd\";\r\nimport { ScreenContainer } from \"components/lib\";\r\nimport React, { useCallback } from \"react\";\r\nimport { useDocumentTitle } from \"utils\";\r\nimport { useKanbans, useReorderKanban } from \"utils/kanban\";\r\nimport { useReorderTask, useTasks } from \"utils/task\";\r\nimport { CreateKanban } from \"./createKanban\";\r\nimport { KanbanColumn } from \"./kanbanColumn\";\r\nimport { SearchPanel } from \"./searchPanel\";\r\nimport { TaskModal } from \"./taskModal\";\r\nimport { DragDropContext, DropResult } from \"react-beautiful-dnd\";\r\nimport { useKanbanQuerykey, useKanbanSearchParams, useProjectInUrl, useTasksQueryKey, useTasksSearchParams } from \"./util\";\r\nimport { Drop, DropChild, Drag } from \"components/dragAndDrop\";\r\n\r\nexport const KanbanScreen = () => {\r\n    useDocumentTitle(\"看板列表\");\r\n    const { data: currentProject } = useProjectInUrl();\r\n    const { data: kanbans, isLoading: kanbanIsLoading } = useKanbans(useKanbanSearchParams());\r\n    const { isLoading: taskIsLoading } = useTasks(useTasksSearchParams());\r\n    const isLoading = kanbanIsLoading || taskIsLoading;\r\n\r\n    const onDragEnd = useDragEnd();\r\n    return (\r\n        <DragDropContext\r\n            onDragEnd={({ ...params }) => {\r\n                console.log(params);\r\n                onDragEnd(params);\r\n            }}\r\n        >\r\n            <ScreenContainer>\r\n                <h1>{currentProject?.name}看板</h1>\r\n                <SearchPanel />\r\n                {isLoading ? (\r\n                    <Spin size={\"large\"} />\r\n                ) : (\r\n                    <ColumnsContainer>\r\n                        <Drop type={\"COLUMN\"} direction={\"horizontal\"} droppableId={\"kanban\"}>\r\n                            <DropChild style={{ display: \"flex\" }}>\r\n                                {kanbans?.map((kanban, index) => {\r\n                                    return (\r\n                                        <Drag key={kanban.id} draggableId={\"kanban\" + kanban.id} index={index}>\r\n                                            <KanbanColumn kanban={kanban} key={kanban.id} />\r\n                                        </Drag>\r\n                                    );\r\n                                })}\r\n                            </DropChild>\r\n                        </Drop>\r\n                        <CreateKanban />\r\n                    </ColumnsContainer>\r\n                )}\r\n                <TaskModal />\r\n            </ScreenContainer>\r\n        </DragDropContext>\r\n    );\r\n};\r\n/**捕获onDragEnd的参数对数据进行操作 */\r\nexport const useDragEnd = () => {\r\n    //从接口中获取kanban和tasks数据\r\n    const { data: kanbans } = useKanbans(useKanbanSearchParams());\r\n    const { data: allTasks = [] } = useTasks(useTasksSearchParams());\r\n\r\n    const { mutate: reorderKanban } = useReorderKanban(useKanbanQuerykey());\r\n    const { mutate: reorderTask } = useReorderTask(useTasksQueryKey());\r\n\r\n    // source表示始，destination表示终\r\n    return useCallback(\r\n        ({ source, destination, type }: DropResult) => {\r\n            if (!destination) {\r\n                return;\r\n            }\r\n            //如果是横向排序\r\n            if (type === \"COLUMN\") {\r\n                const fromId = kanbans?.[source.index].id;\r\n                const toId = kanbans?.[destination.index].id;\r\n                if (!fromId || !toId || fromId === toId) {\r\n                    return;\r\n                }\r\n                const type = destination.index > source.index ? \"after\" : \"before\";\r\n\r\n                reorderKanban({ fromId, referenceId: toId, type });\r\n            }\r\n            //如果是纵向排序task\r\n            if (type === \"ROW\") {\r\n                const fromKanbanId = +source.droppableId;\r\n                const toKanbanId = +destination.droppableId;\r\n\r\n                //看板排序task\r\n                const fromTask = allTasks.filter((task) => {\r\n                    return task.kanbanId === fromKanbanId;\r\n                })[source.index];\r\n                const toTask = allTasks.filter((task) => {\r\n                    return task.kanbanId === toKanbanId;\r\n                })[destination.index];\r\n                //如果要排序的两个相同，啥都不做\r\n                if (fromTask?.id === toTask?.id) {\r\n                    return;\r\n                }\r\n                const type = destination.index > source.index ? \"after\" : \"before\";\r\n                reorderTask({ fromId: fromTask?.id, referenceId: toTask?.id, fromKanbanId, toKanbanId, type: type });\r\n            }\r\n        },\r\n        [allTasks, kanbans, reorderKanban, reorderTask]\r\n    );\r\n};\r\n\r\nexport const ColumnsContainer = styled(\"div\")`\r\n    display: flex;\r\n    overflow-y: hidden;\r\n    flex: 1;\r\n`;\r\n","import styled from \"@emotion/styled\";\r\nimport { Menu } from \"antd\";\r\nimport React from \"react\";\r\nimport { Navigate, Route, Routes, useLocation } from \"react-router\";\r\nimport { Link } from \"react-router-dom\";\r\nimport { EpicScreen } from \"screens/epic\";\r\nimport { KanbanScreen } from \"screens/kanban\";\r\nconst useRouteType = () => {\r\n    const units = useLocation().pathname.split(\"/\");\r\n    return units[units.length - 1];\r\n};\r\nexport const ProjectScreen = () => {\r\n    const routerType = useRouteType();\r\n    return (\r\n        <Container>\r\n            <Aside>\r\n                <Menu mode={\"inline\"} selectedKeys={[routerType]}>\r\n                    <Menu.Item key={\"kanban\"}>\r\n                        <Link to={\"kanban\"}>看板</Link>\r\n                    </Menu.Item>\r\n                    <Menu.Item key={\"epic\"}>\r\n                        <Link to={\"epic\"}>任务组</Link>\r\n                    </Menu.Item>\r\n                </Menu>\r\n            </Aside>\r\n\r\n            <Main>\r\n                <Routes>\r\n                    <Route path={\"/kanban\"} element={<KanbanScreen />} />\r\n                    <Route path={\"/epic\"} element={<EpicScreen />} />\r\n                    <Navigate to={window.location.pathname + \"/kanban\"} replace={true} />\r\n                </Routes>\r\n            </Main>\r\n        </Container>\r\n    );\r\n};\r\nProjectScreen.whyDidYouRender = true;\r\nconst Aside = styled.aside`\r\n    background-color: rgb(244, 245, 247);\r\n    display: flex;\r\n`;\r\n\r\nconst Main = styled.div`\r\n    display: flex;\r\n    overflow: hidden;\r\n    box-shadow: -5px 0 5px -5px rgba(0, 0, 0, 0.1);\r\n`;\r\n\r\nconst Container = styled.div`\r\n    display: grid;\r\n    overflow: hidden;\r\n    grid-template-columns: 16rem 1fr;\r\n`;\r\n","import styled from \"@emotion/styled\";\r\nimport { Button, Drawer, Form, Input, Spin } from \"antd\";\r\nimport { ErrorBox } from \"components/lib\";\r\nimport { UserSelect } from \"components/userSelect\";\r\nimport React from \"react\";\r\nimport { useEffect } from \"react\";\r\nimport { useAddProject, useEditProject } from \"utils/useProjects\";\r\nimport { useProjectModal, useProjectQueryKey } from \"./utils\";\r\nexport const ProjectModal = () => {\r\n    const { projectModalOpen, close, editingProject, isLoading } = useProjectModal();\r\n    const useMutateProject = editingProject ? useEditProject : useAddProject;\r\n    const { mutateAsync, error, isLoading: mutateLoading } = useMutateProject(useProjectQueryKey());\r\n    const [form] = Form.useForm();\r\n    /**表单提交 */\r\n    const onFinish = (values: any) => {\r\n        mutateAsync({ ...editingProject, ...values }).then(() => {\r\n            form.resetFields();\r\n            close();\r\n        });\r\n    };\r\n    /**关闭drawer */\r\n    const closeModal = () => {\r\n        form.resetFields();\r\n        close();\r\n    };\r\n    const title = editingProject ? \"编辑项目\" : \"创建项目\";\r\n    //当editingProject改变时\r\n    useEffect(() => {\r\n        //将editingProject赋值给表单\r\n        form.setFieldsValue(editingProject);\r\n    }, [editingProject, form]);\r\n    return (\r\n        <Drawer forceRender={true} onClose={closeModal} visible={projectModalOpen} width={\"100%\"}>\r\n            <Container>\r\n                {isLoading ? <Spin size={\"large\"} /> : <h1>{title}</h1>}\r\n                <ErrorBox error={error} />\r\n                <Form form={form} layout={\"vertical\"} style={{ width: \"40rem\" }} onFinish={onFinish}>\r\n                    <Form.Item label={\"名称\"} name={\"name\"} rules={[{ required: true, message: \"请输入项目名称\" }]}>\r\n                        <Input placeholder={\"请输入项目名称\"} />\r\n                    </Form.Item>\r\n                    <Form.Item label={\"部门\"} name={\"organization\"} rules={[{ required: true, message: \"请输入部门名称\" }]}>\r\n                        <Input placeholder={\"请输入部门名称\"} />\r\n                    </Form.Item>\r\n                    <Form.Item label={\"负责人\"} name={\"personId\"}>\r\n                        <UserSelect defaultOptionName={\"负责人\"} />\r\n                    </Form.Item>\r\n                    <Form.Item style={{ textAlign: \"right\" }}>\r\n                        <Button loading={mutateLoading} type={\"primary\"} htmlType={\"submit\"}>\r\n                            提交\r\n                        </Button>\r\n                    </Form.Item>\r\n                </Form>\r\n            </Container>\r\n        </Drawer>\r\n    );\r\n};\r\n\r\nconst Container = styled.div`\r\n    display: flex;\r\n    height: 80vh;\r\n    justify-content: center;\r\n    align-items: center;\r\n    flex-direction: column;\r\n`;\r\n","import styled from \"@emotion/styled\";\r\nimport { Divider, List, Popover, Typography } from \"antd\";\r\nimport React from \"react\";\r\nimport { useProjectModal } from \"screens/projectList/utils\";\r\nimport { useProjects } from \"utils/useProjects\";\r\nimport { ButtonNoPadding } from \"./lib\";\r\nexport const ProjectPopover = () => {\r\n    const { data: projects, refetch } = useProjects();\r\n\r\n    const { open } = useProjectModal();\r\n    const pinnedProjects = projects?.filter((project) => project.pin);\r\n    const content = (\r\n        <ContentContainer>\r\n            <Typography.Text type={\"secondary\"}>收藏项目</Typography.Text>\r\n            <List>\r\n                {pinnedProjects?.map((project) => {\r\n                    return (\r\n                        <List.Item key={project.id}>\r\n                            <List.Item.Meta title={project.name} />\r\n                        </List.Item>\r\n                    );\r\n                })}\r\n            </List>\r\n            <Divider />\r\n            <ButtonNoPadding type={\"link\"} onClick={() => open()}>\r\n                编辑\r\n            </ButtonNoPadding>\r\n        </ContentContainer>\r\n    );\r\n    return (\r\n        <Popover onVisibleChange={() => refetch()} placement={\"bottom\"} content={content}>\r\n            <span>项目</span>\r\n        </Popover>\r\n    );\r\n};\r\n\r\nconst ContentContainer = styled.div`\r\n    min-width: 30rem;\r\n`;\r\n","import styled from \"@emotion/styled\";\r\nimport { Divider, List, Popover, Typography } from \"antd\";\r\nimport React from \"react\";\r\nimport { useUsers } from \"utils/useUsers\";\r\nexport const UserPopover = () => {\r\n    const { data: users, refetch } = useUsers();\r\n\r\n    const content = (\r\n        <ContentContainer>\r\n            <Typography.Text type={\"secondary\"}>组员列表</Typography.Text>\r\n            <List>\r\n                {users?.map((user) => {\r\n                    return (\r\n                        <List.Item key={user.id}>\r\n                            <List.Item.Meta title={user.name} />\r\n                        </List.Item>\r\n                    );\r\n                })}\r\n            </List>\r\n            <Divider />\r\n        </ContentContainer>\r\n    );\r\n    return (\r\n        <Popover onVisibleChange={() => refetch()} placement={\"bottom\"} content={content}>\r\n            <span>组员</span>\r\n        </Popover>\r\n    );\r\n};\r\n\r\nconst ContentContainer = styled.div`\r\n    min-width: 30rem;\r\n`;\r\n","import { useAuth } from \"context/authContext\";\r\nimport React from \"react\";\r\nimport ProjectListScreen from \"screens/projectList\";\r\nimport styled from \"@emotion/styled\";\r\nimport { ButtonNoPadding, Row } from \"components/lib\";\r\nimport { ReactComponent as SoftwareLogo } from \"assets/software-logo.svg\";\r\nimport { Button, Dropdown, Menu } from \"antd\";\r\nimport { Routes, Navigate, Route } from \"react-router\";\r\nimport { BrowserRouter as Router } from \"react-router-dom\";\r\nimport { ProjectScreen } from \"screens/project\";\r\nimport { resetRoute } from \"utils\";\r\nimport { ProjectModal } from \"screens/projectList/projectModal\";\r\nimport { ProjectPopover } from \"components/projectPopover\";\r\nimport { UserPopover } from \"components/userPopover\";\r\n/**登录成功页面 */\r\nexport const AuthenticatedApp = () => {\r\n    return (\r\n        <Container>\r\n            <Router>\r\n                <PageHeader />\r\n                <Main>\r\n                    <Routes>\r\n                        <Route path={\"/projects\"} element={<ProjectListScreen />} />\r\n                        <Route path={\"/projects/:projectId/*\"} element={<ProjectScreen />} />\r\n                        {/* 默认路由 */}\r\n                        <Navigate to={\"/projects\"} />\r\n                    </Routes>\r\n                </Main>\r\n                <ProjectModal />\r\n            </Router>\r\n        </Container>\r\n    );\r\n};\r\n\r\n/**公共的Header*/\r\nconst PageHeader = () => {\r\n    return (\r\n        <Header between={true}>\r\n            <HeaderLeft gap={true}>\r\n                <ButtonNoPadding type={\"link\"} onClick={() => resetRoute()}>\r\n                    <SoftwareLogo width={\"18rem\"} color={\"rgb(38,132,255)\"} />\r\n                </ButtonNoPadding>\r\n                <ProjectPopover />\r\n                <UserPopover />\r\n            </HeaderLeft>\r\n            <HeaderRight>\r\n                <User />\r\n            </HeaderRight>\r\n        </Header>\r\n    );\r\n};\r\n\r\nconst User = () => {\r\n    const { loginOut, user } = useAuth();\r\n    return (\r\n        <Dropdown\r\n            overlay={\r\n                <Menu>\r\n                    <Menu.Item>\r\n                        <Button type={\"link\"} onClick={loginOut}>\r\n                            登出\r\n                        </Button>\r\n                    </Menu.Item>\r\n                </Menu>\r\n            }\r\n        >\r\n            <Button type={\"link\"} onClick={(e) => e.preventDefault()}>\r\n                Hi,{user?.name}\r\n            </Button>\r\n        </Dropdown>\r\n    );\r\n};\r\n\r\nconst Container = styled.div`\r\n    display: grid;\r\n    grid-template-rows: 6rem 1fr;\r\n    height: 100vh;\r\n`;\r\n// const Container = styled.div`\r\n//     display: grid;\r\n//     grid-template-rows: 6rem 1fr 6rem; /**高 */\r\n//     grid-template-columns: 20rem 1fr 20rem; /**宽 */\r\n//     grid-gap: 2rem; /**每个模块间的距离 */\r\n//     grid-template-areas: /**布局的样式组成 */\r\n//         \"header header header\"\r\n//         \"nav main aside\"\r\n//         \"footer footer footer\";\r\n//     height: 100vh;\r\n// `;\r\n\r\nconst Header = styled(Row)`\r\n    padding: 3.2rem;\r\n    box-shadow: 0 0 5px 0 rgba(0, 0, 0, 0.1);\r\n    z-index: 1;\r\n`;\r\nconst HeaderLeft = styled(Row)``;\r\nconst HeaderRight = styled.div``;\r\n\r\nconst Main = styled.main`\r\n    display: flex;\r\n    overflow: hidden;\r\n    flex-direction: column;\r\n`;\r\n","import React from \"react\";\r\nimport { useAuth } from \"context/authContext\";\r\nimport { Form, Input } from \"antd\";\r\nimport { LongButton } from \"unauthenticatedApp\";\r\nimport { useAsync } from \"utils/useAsync\";\r\ninterface LoginScreenProps {\r\n    onError: (error: Error) => void;\r\n}\r\n/**登录页面 */\r\nconst LoginScreen = ({ onError }: LoginScreenProps) => {\r\n    const { login } = useAuth();\r\n    const { run, isLoading } = useAsync(undefined, { throwOnError: true }); //用于登录按钮的状态\r\n    const handleSubmit = (values: { username: string; password: string }) => {\r\n        run(login(values)).catch((e) => {\r\n            onError(e);\r\n        });\r\n    };\r\n    return (\r\n        <Form onFinish={handleSubmit}>\r\n            <Form.Item name={\"username\"} rules={[{ required: true, message: \"请输入用户名\" }]}>\r\n                <Input placeholder={\"用户名\"} type=\"text\" id={\"username\"} />\r\n            </Form.Item>\r\n            <Form.Item name={\"password\"} rules={[{ required: true, message: \"请输入密码\" }]}>\r\n                <Input placeholder={\"密码\"} type=\"password\" id={\"password\"} />\r\n            </Form.Item>\r\n            <Form.Item>\r\n                <LongButton loading={isLoading} htmlType={\"submit\"} type={\"primary\"}>\r\n                    登录\r\n                </LongButton>\r\n            </Form.Item>\r\n        </Form>\r\n    );\r\n};\r\n\r\nexport default LoginScreen;\r\n","import React from \"react\";\r\nimport { useAuth } from \"context/authContext\";\r\nimport { Form, Input } from \"antd\";\r\nimport { LongButton } from \"unauthenticatedApp\";\r\nimport { useAsync } from \"utils/useAsync\";\r\ninterface RegisterScreenProps {\r\n    onError: (error: Error) => void; //向外部抛出错误\r\n}\r\n/**注册页面 */\r\nconst RegisterScreen = ({ onError }: RegisterScreenProps) => {\r\n    const { register } = useAuth();\r\n    const { run, isLoading } = useAsync(undefined, { throwOnError: true }); //用于注册按钮的状态\r\n    const handleSubmit = ({ cpassword, ...values }: { username: string; password: string; cpassword: string }) => {\r\n        if (cpassword !== values.password) {\r\n            onError(new Error(\"请确认两次密码输入相同\"));\r\n            return;\r\n        }\r\n        run(register(values)).catch((e) => {\r\n            onError(e);\r\n        });\r\n    };\r\n    return (\r\n        <Form onFinish={handleSubmit}>\r\n            <Form.Item name={\"username\"} rules={[{ required: true, message: \"请输入用户名\" }]}>\r\n                <Input placeholder={\"用户名\"} type=\"text\" id={\"username\"} />\r\n            </Form.Item>\r\n            <Form.Item name={\"password\"} rules={[{ required: true, message: \"请输入密码\" }]}>\r\n                <Input placeholder={\"密码\"} type=\"password\" id={\"password\"} />\r\n            </Form.Item>\r\n\r\n            <Form.Item name={\"cpassword\"} rules={[{ required: true, message: \"请确认密码\" }]}>\r\n                <Input placeholder={\"请确认密码\"} type=\"password\" id={\"cpassword\"} />\r\n            </Form.Item>\r\n            <Form.Item>\r\n                <LongButton loading={isLoading} htmlType={\"submit\"} type={\"primary\"}>\r\n                    注册\r\n                </LongButton>\r\n            </Form.Item>\r\n        </Form>\r\n    );\r\n};\r\n\r\nexport default RegisterScreen;\r\n","export default __webpack_public_path__ + \"static/media/logo.8bb06c97.svg\";","export default __webpack_public_path__ + \"static/media/left.e74de3ec.svg\";","export default __webpack_public_path__ + \"static/media/right.890da620.svg\";","import React, { useState } from \"react\";\r\nimport LoginScreen from \"unauthenticatedApp/login\";\r\nimport RegisterScreen from \"unauthenticatedApp/register\";\r\nimport { Button, Card, Divider } from \"antd\";\r\nimport styled from \"@emotion/styled\";\r\nimport logo from \"assets/logo.svg\";\r\nimport left from \"assets/left.svg\";\r\nimport right from \"assets/right.svg\";\r\n// import { Helmet } from \"react-helmet\";\r\nimport { useDocumentTitle } from \"utils\";\r\nimport { ErrorBox } from \"components/lib\";\r\n/**未登录页面 包括注册登录页面 */\r\nexport const UnauthenticatedApp = () => {\r\n    const [isRegister, setIsRegister] = useState(false);\r\n    const [error, setError] = useState<Error | null>(null);\r\n    useDocumentTitle(\"请登录注册\", false);\r\n    return (\r\n        <Container>\r\n            <Header />\r\n            <Background />\r\n            <ShadowCard>\r\n                <Title>{isRegister ? \"请注册\" : \"请登录\"}</Title>\r\n                <ErrorBox error={error} />\r\n                {isRegister ? <RegisterScreen onError={setError} /> : <LoginScreen onError={setError} />}\r\n                {/**分割线 */}\r\n                <Divider />\r\n                <Button\r\n                    type={\"link\"}\r\n                    onClick={() => {\r\n                        setIsRegister(!isRegister);\r\n                        setError(null);\r\n                    }}\r\n                >\r\n                    {isRegister ? \"已经有账号了？直接登录\" : \"没有账号？注册新账号\"}\r\n                </Button>\r\n            </ShadowCard>\r\n        </Container>\r\n    );\r\n};\r\n\r\nexport const LongButton = styled(Button)`\r\n    width: 100%;\r\n`;\r\n\r\nconst Title = styled.h2`\r\n    margin-bottom: 2.4rem;\r\n    color: rgb(94, 108, 132);\r\n`;\r\n\r\nconst Background = styled.div`\r\n    position: absolute;\r\n    width: 100%;\r\n    height: 100%;\r\n    background-repeat: no-repeat;\r\n    background-attachment: fixed;\r\n    background-position: left bottom, right bottom;\r\n    background-size: calc(((100vw - 40rem) / 2) - 3.2rem), calc(((100vw - 40rem) / 2) - 3.2rem), cover;\r\n    background-image: url(${left}), url(${right});\r\n`;\r\nconst Header = styled.header`\r\n    background: url(${logo}) no-repeat center;\r\n    padding: 5rem 0;\r\n    background-size: 8rem;\r\n    width: 100%;\r\n`;\r\nconst ShadowCard = styled(Card)`\r\n    width: 40rem;\r\n    min-height: 56rem;\r\n    padding: 3.2rem 4rem;\r\n    box-sizing: border-box;\r\n    box-shadow: rgba(0, 0, 0, 0.1) 0 0 10px;\r\n    text-align: center;\r\n`;\r\n\r\nconst Container = styled.div`\r\n    display: flex;\r\n    flex-direction: column;\r\n    align-items: center;\r\n    min-height: 100vh;\r\n`;\r\n","import React from \"react\";\r\ntype FallbackRender = (props: { error: Error | null }) => React.ReactElement;\r\n/**捕获错误边界 主要用于捕获未知错误*/\r\n//React.Component接收两个参数类型第一个是props的类型，第二个是state的类型\r\n// props类型：PropsWithChildren默认会加上Children:ReactNode\r\n// React.PropsWithChildren<{ fallBackRender: FallBackRender }> 就等于 { children:ReactNode,fallBackRender:FallBackRender }\r\n// state类型:\r\n// https://github.com/bvaughn/react-error-boundary\r\nexport class ErrorBoundary extends React.Component<React.PropsWithChildren<{ fallbackRender: FallbackRender }>, { error: Error | null }> {\r\n    // constructor(props) {\r\n    //     super(props);\r\n    //     this.state = {};\r\n    // }\r\n    state = { error: null };\r\n    //当子组件抛出异常，这里会接收到并调用\r\n    static getDerivedStateFromError(error: Error) {\r\n        return { error };\r\n    }\r\n    render() {\r\n        const { error } = this.state;\r\n        const { fallbackRender, children } = this.props;\r\n        //错误的时候渲染\r\n        if (error) {\r\n            return fallbackRender({ error });\r\n        }\r\n        //正常渲染\r\n        return children;\r\n    }\r\n}\r\n","import React from \"react\";\r\nimport \"./App.css\";\r\nimport { useAuth } from \"context/authContext\";\r\nimport { AuthenticatedApp } from \"authenticatedApp\";\r\nimport { UnauthenticatedApp } from \"unauthenticatedApp\";\r\nimport { ErrorBoundary } from \"components/errorBoundary\";\r\nimport { FullPageErrorFallback } from \"components/lib\";\r\n\r\nfunction App() {\r\n    const { user } = useAuth();\r\n    return (\r\n        <div className=\"App\">\r\n            <ErrorBoundary fallbackRender={FullPageErrorFallback}>{user ? <AuthenticatedApp /> : <UnauthenticatedApp />}</ErrorBoundary>\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default App;\r\n","import { ReportHandler } from 'web-vitals';\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React, { ReactNode } from \"react\";\r\nimport { AuthProvider } from \"context/authContext\";\r\nimport { QueryClient, QueryClientProvider } from \"react-query\";\r\n\r\nexport const AppProviders = ({ children }: { children: ReactNode }) => {\r\n    const queryClient = new QueryClient();\r\n    return (\r\n        <QueryClientProvider client={queryClient}>\r\n            <AuthProvider>{children}</AuthProvider>\r\n        </QueryClientProvider>\r\n    );\r\n};\r\n","import \"./wdyr\";\r\nimport React from \"react\";\r\nimport ReactDOM from \"react-dom\";\r\nimport App from \"./App\";\r\nimport reportWebVitals from \"./reportWebVitals\";\r\nimport { loadServer, DevTools } from \"jira-dev-tool\";\r\nimport \"antd/dist/antd.less\";\r\nimport { AppProviders } from \"context\";\r\nloadServer(() =>\r\n    ReactDOM.render(\r\n        <React.StrictMode>\r\n            <AppProviders>\r\n                <DevTools />\r\n                <App />\r\n            </AppProviders>\r\n        </React.StrictMode>,\r\n        document.getElementById(\"root\")\r\n    )\r\n);\r\n\r\n// If you want to start measuring performance in your app, pass a function\r\n// to log results (for example: reportWebVitals(console.log))\r\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\r\nreportWebVitals();\r\n"],"sourceRoot":""}